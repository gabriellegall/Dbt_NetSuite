DONE :
- Refine the Sales Pipeline definition with Open SO/Opp. based on a variable
- Data Quality
    b- field allowed values eg. Opportunity Statuses with Open vs Closed mapping
- Review the delta update strategy : transaction_nsid must be completely deleted and re-integrated
- Add IF EXISTS to pre hook in transaction_with_line
- Document query optimization
- Data Quality
    a- raw_netsuite vs ds_layers amounts

TO DO :
- # To do : check the Pk on snapshotted data to ensure that the column snapshot date is indeed considered, and not just a string
- Data Quality
    c- unique & not null constraints
    d- has fx conversion to usd
- Check if I manage to import an external package for T-SQL and fix the UNPIVOT for instance
- Understand what the hell is going on with this : https://github.com/dbt-msft/tsql-utils/tree/main
- Add a datetable ?

- Field Documentation
- Table Documentation
- Document full integration tests
- README.md / Dbt docs : file explaining the project, design choices, and optimization

, post_hook = 'ALTER TABLE [dwh].[transaction_with_line]
               ALTER COLUMN [transaction_nsid] INT NOT NULL;
               ALTER TABLE [dwh].[transaction_with_line]
               ALTER COLUMN [transaction_line_nsid] INT NOT NULL;
               ALTER TABLE [dwh].[transaction_with_line]
               ADD CONSTRAINT pk_transaction_with_line PRIMARY KEY NONCLUSTERED ([transaction_nsid], [transaction_line_nsid]);'