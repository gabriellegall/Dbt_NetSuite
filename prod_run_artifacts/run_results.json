{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.18", "generated_at": "2024-09-06T23:04:23.698888Z", "invocation_id": "0869de00-29eb-41d1-8e0f-5c1902539395", "env": {}}, "results": [{"status": "pass", "timing": [{"name": "compile", "started_at": "2024-09-06T23:04:21.974958Z", "completed_at": "2024-09-06T23:04:22.001958Z"}, {"name": "execute", "started_at": "2024-09-06T23:04:22.002958Z", "completed_at": "2024-09-06T23:04:22.088954Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.11799836158752441, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": null, "failures": 0, "unique_id": "test.netsuite_project.dbt_utils_unique_combination_of_columns_historized_transaction_with_line_var_dbt_snapshot_col_name___transaction_nsid__transaction_line_nsid.8021ab7f24", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        dbt_functional_snapshot_date, transaction_nsid, transaction_line_nsid\n    from \"netsuite\".\"prod_dwh\".\"historized_transaction_with_line\"\n    group by dbt_functional_snapshot_date, transaction_nsid, transaction_line_nsid\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-09-06T23:04:22.095956Z", "completed_at": "2024-09-06T23:04:22.104957Z"}, {"name": "execute", "started_at": "2024-09-06T23:04:22.106960Z", "completed_at": "2024-09-06T23:04:22.393957Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.30199742317199707, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": null, "failures": 0, "unique_id": "test.netsuite_project.not_null_fact_all_transactions_with_line_fx_rate_original_to_dynamic.80ae594c95", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect fx_rate_original_to_dynamic\nfrom \"netsuite\".\"prod_bus\".\"fact_all_transactions_with_line\"\nwhere fx_rate_original_to_dynamic is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-09-06T23:04:22.400955Z", "completed_at": "2024-09-06T23:04:22.406957Z"}, {"name": "execute", "started_at": "2024-09-06T23:04:22.407954Z", "completed_at": "2024-09-06T23:04:22.528954Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.1309981346130371, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": null, "failures": 0, "unique_id": "test.netsuite_project.not_null_fact_all_transactions_with_line_fx_rate_original_to_usd.0896bf129b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect fx_rate_original_to_usd\nfrom \"netsuite\".\"prod_bus\".\"fact_all_transactions_with_line\"\nwhere fx_rate_original_to_usd is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-09-06T23:04:22.534956Z", "completed_at": "2024-09-06T23:04:22.542959Z"}, {"name": "execute", "started_at": "2024-09-06T23:04:22.544956Z", "completed_at": "2024-09-06T23:04:22.554955Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.022997140884399414, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": null, "failures": 0, "unique_id": "test.netsuite_project.not_null_historized_transaction_with_line_transaction_line_nsid.c46e56a2e1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect transaction_line_nsid\nfrom \"netsuite\".\"prod_dwh\".\"historized_transaction_with_line\"\nwhere transaction_line_nsid is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-09-06T23:04:22.562959Z", "completed_at": "2024-09-06T23:04:22.569954Z"}, {"name": "execute", "started_at": "2024-09-06T23:04:22.570957Z", "completed_at": "2024-09-06T23:04:22.581955Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02200031280517578, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": null, "failures": 0, "unique_id": "test.netsuite_project.not_null_historized_transaction_with_line_transaction_nsid.4b11b8bce6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect transaction_nsid\nfrom \"netsuite\".\"prod_dwh\".\"historized_transaction_with_line\"\nwhere transaction_nsid is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-09-06T23:04:22.587957Z", "completed_at": "2024-09-06T23:04:22.594955Z"}, {"name": "execute", "started_at": "2024-09-06T23:04:22.595956Z", "completed_at": "2024-09-06T23:04:22.631954Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0469970703125, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": null, "failures": 0, "unique_id": "test.netsuite_project.not_null_prep_budget_for_union_live_bu_code.d946ceafd7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect live_bu_code\nfrom \"netsuite\".\"prod_prp\".\"prep_budget_for_union\"\nwhere live_bu_code is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-09-06T23:04:22.638954Z", "completed_at": "2024-09-06T23:04:22.745957Z"}, {"name": "execute", "started_at": "2024-09-06T23:04:22.746956Z", "completed_at": "2024-09-06T23:04:23.574886Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.9399275779724121, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": null, "failures": 0, "unique_id": "test.netsuite_project.test_incremental_load", "compiled": true, "compiled_code": "\n\n\n\n\n\nWITH cte_incremental_table AS (\nSELECT\n\t\"transaction_nsid\",\n  \"transaction_line_nsid\",\n  \"transaction_last_modified_date\",\n  \"transaction_line_last_modified_date\",\n  \"transaction_type\",\n  \"transaction_number\",\n  \"transaction_status\",\n  \"transaction_date\",\n  \"expected_delivery_date\",\n  \"foreign_amount\",\n  \"foreign_currency\",\n  \"quantity\",\n  \"bu_rate\",\n  \"bu_amount\",\n  \"fk_item_nsid\",\n  \"fk_bu_nsid\",\n  \"fk_customer_nsid\"\n\t, CHECKSUM (\"transaction_nsid\",\n  \"transaction_line_nsid\",\n  \"transaction_last_modified_date\",\n  \"transaction_line_last_modified_date\",\n  \"transaction_type\",\n  \"transaction_number\",\n  \"transaction_status\",\n  \"transaction_date\",\n  \"expected_delivery_date\",\n  \"foreign_amount\",\n  \"foreign_currency\",\n  \"quantity\",\n  \"bu_rate\",\n  \"bu_amount\",\n  \"fk_item_nsid\",\n  \"fk_bu_nsid\",\n  \"fk_customer_nsid\" ) AS checksum_result\nFROM \"netsuite\".\"prod_dwh\".\"transaction_with_line\" )\n\n, cte_current_table AS (\nSELECT\n\t\"transaction_nsid\",\n  \"transaction_line_nsid\",\n  \"transaction_last_modified_date\",\n  \"transaction_line_last_modified_date\",\n  \"transaction_type\",\n  \"transaction_number\",\n  \"transaction_status\",\n  \"transaction_date\",\n  \"expected_delivery_date\",\n  \"foreign_amount\",\n  \"foreign_currency\",\n  \"quantity\",\n  \"bu_rate\",\n  \"bu_amount\",\n  \"fk_item_nsid\",\n  \"fk_bu_nsid\",\n  \"fk_customer_nsid\"\n\t, CHECKSUM (\"transaction_nsid\",\n  \"transaction_line_nsid\",\n  \"transaction_last_modified_date\",\n  \"transaction_line_last_modified_date\",\n  \"transaction_type\",\n  \"transaction_number\",\n  \"transaction_status\",\n  \"transaction_date\",\n  \"expected_delivery_date\",\n  \"foreign_amount\",\n  \"foreign_currency\",\n  \"quantity\",\n  \"bu_rate\",\n  \"bu_amount\",\n  \"fk_item_nsid\",\n  \"fk_bu_nsid\",\n  \"fk_customer_nsid\" ) AS checksum_result\nFROM \"netsuite\".\"prod_prp\".\"prep_transaction_with_lines\" )\n\nSELECT \n\tcte_incremental_table.transaction_nsid\t\t\tAS incremental_transaction_nsid\n    , cte_incremental_table.transaction_line_nsid\tAS incremental_transaction_line_nsid\n\t, cte_current_table.transaction_nsid\t\t\tAS current_transaction_nsid\n    , cte_current_table.transaction_line_nsid\t\tAS current_transaction_line_nsid\n\t, CASE \n\t\tWHEN cte_incremental_table.transaction_nsid IS NOT NULL THEN 'Hash present in incremental table exclusively'\n\t\tWHEN cte_current_table.transaction_nsid IS NOT NULL THEN 'Hash present in current table exclusively'\n\tEND \t\t\t\t\t\t\t\t\t\t\tAS control_warning_description\n\t\nFROM cte_incremental_table\nFULL OUTER JOIN cte_current_table\n\tON cte_incremental_table.checksum_result = cte_current_table.checksum_result\nWHERE cte_incremental_table.checksum_result IS NULL\n\tOR cte_current_table.checksum_result IS NULL", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-09-06T23:04:23.580891Z", "completed_at": "2024-09-06T23:04:23.592887Z"}, {"name": "execute", "started_at": "2024-09-06T23:04:23.594887Z", "completed_at": "2024-09-06T23:04:23.654890Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0760042667388916, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": null, "failures": 0, "unique_id": "test.netsuite_project.unexpected_opportunity_status.a0dda7bad4", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        transaction_status as value_field,\n        count(*) as n_records\n\n    from (select * from \"netsuite\".\"prod_dwh\".\"transaction_with_line\" where transaction_type = 'Opportunity') dbt_subquery\n    group by transaction_status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Under Discussion','Ongoing','Closed - Won','Closed - Lost'\n)\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-09-06T23:04:23.660885Z", "completed_at": "2024-09-06T23:04:23.668889Z"}, {"name": "execute", "started_at": "2024-09-06T23:04:23.669888Z", "completed_at": "2024-09-06T23:04:23.689891Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0330047607421875, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": null, "failures": 0, "unique_id": "test.netsuite_project.unexpected_sales_order_status.5f4b39d9f8", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        transaction_status as value_field,\n        count(*) as n_records\n\n    from (select * from \"netsuite\".\"prod_dwh\".\"transaction_with_line\" where transaction_type = 'Sales Order') dbt_subquery\n    group by transaction_status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Under Discussion','Ongoing','Closed - Won','Closed - Lost'\n)\n\n\n", "relation_name": null}], "elapsed_time": 1.8629319667816162, "args": {"printer_width": 80, "send_anonymous_usage_stats": true, "populate_cache": true, "use_colors": true, "invocation_command": "dbt test", "which": "test", "partial_parse_file_diff": true, "strict_mode": false, "log_level_file": "debug", "show_resource_report": false, "exclude": [], "project_dir": "C:\\Users\\User\\netsuite_project", "log_format": "default", "partial_parse": true, "static_parser": true, "favor_state": false, "quiet": false, "profiles_dir": "C:\\Users\\User\\netsuite_project", "version_check": true, "enable_legacy_logger": false, "use_colors_file": true, "warn_error_options": {"include": [], "exclude": []}, "macro_debugging": false, "indirect_selection": "eager", "log_path": "C:\\Users\\User\\netsuite_project\\logs", "vars": {}, "log_file_max_bytes": 10485760, "log_format_file": "debug", "introspect": true, "write_json": true, "print": true, "require_explicit_package_overrides_for_builtin_materializations": false, "log_level": "info", "cache_selected_only": false, "defer": false, "select": []}}