{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.18", "generated_at": "2024-09-08T17:51:21.005613Z", "invocation_id": "af036597-4cb1-47bd-8697-8a6ac9438eeb", "env": {}}, "results": [{"status": "pass", "timing": [{"name": "compile", "started_at": "2024-09-08T17:50:51.059234Z", "completed_at": "2024-09-08T17:50:51.083236Z"}, {"name": "execute", "started_at": "2024-09-08T17:50:51.084236Z", "completed_at": "2024-09-08T17:50:52.036613Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.9813768863677979, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": null, "failures": 0, "unique_id": "test.netsuite_project.dbt_utils_unique_combination_of_columns_historized_transaction_with_line_var_dbt_snapshot_col_name___transaction_nsid__transaction_line_nsid.8021ab7f24", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        dbt_functional_snapshot_date, transaction_nsid, transaction_line_nsid\n    from \"netsuite\".\"prod_dwh\".\"historized_transaction_with_line\"\n    group by dbt_functional_snapshot_date, transaction_nsid, transaction_line_nsid\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-09-08T17:50:52.042613Z", "completed_at": "2024-09-08T17:50:52.052613Z"}, {"name": "execute", "started_at": "2024-09-08T17:50:52.053613Z", "completed_at": "2024-09-08T17:50:56.834613Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.795001268386841, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": null, "failures": 0, "unique_id": "test.netsuite_project.not_null_fact_all_transactions_with_line_fx_rate_original_to_dynamic.80ae594c95", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect fx_rate_original_to_dynamic\nfrom \"netsuite\".\"prod_bus\".\"fact_all_transactions_with_line\"\nwhere fx_rate_original_to_dynamic is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-09-08T17:50:56.840612Z", "completed_at": "2024-09-08T17:50:56.846613Z"}, {"name": "execute", "started_at": "2024-09-08T17:50:56.847612Z", "completed_at": "2024-09-08T17:51:00.798614Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.9630014896392822, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": null, "failures": 0, "unique_id": "test.netsuite_project.not_null_fact_all_transactions_with_line_fx_rate_original_to_usd.0896bf129b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect fx_rate_original_to_usd\nfrom \"netsuite\".\"prod_bus\".\"fact_all_transactions_with_line\"\nwhere fx_rate_original_to_usd is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-09-08T17:51:00.806612Z", "completed_at": "2024-09-08T17:51:00.813611Z"}, {"name": "execute", "started_at": "2024-09-08T17:51:00.814614Z", "completed_at": "2024-09-08T17:51:00.825613Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.022000551223754883, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": null, "failures": 0, "unique_id": "test.netsuite_project.not_null_historized_transaction_with_line_transaction_line_nsid.c46e56a2e1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect transaction_line_nsid\nfrom \"netsuite\".\"prod_dwh\".\"historized_transaction_with_line\"\nwhere transaction_line_nsid is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-09-08T17:51:00.831613Z", "completed_at": "2024-09-08T17:51:00.837614Z"}, {"name": "execute", "started_at": "2024-09-08T17:51:00.838613Z", "completed_at": "2024-09-08T17:51:00.847613Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01900172233581543, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": null, "failures": 0, "unique_id": "test.netsuite_project.not_null_historized_transaction_with_line_transaction_nsid.4b11b8bce6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect transaction_nsid\nfrom \"netsuite\".\"prod_dwh\".\"historized_transaction_with_line\"\nwhere transaction_nsid is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-09-08T17:51:00.853621Z", "completed_at": "2024-09-08T17:51:00.859615Z"}, {"name": "execute", "started_at": "2024-09-08T17:51:00.861613Z", "completed_at": "2024-09-08T17:51:00.890613Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04000115394592285, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": null, "failures": 0, "unique_id": "test.netsuite_project.not_null_prep_budget_for_union_live_bu_code.d946ceafd7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect live_bu_code\nfrom \"netsuite\".\"prod_prp\".\"prep_budget_for_union\"\nwhere live_bu_code is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-09-08T17:51:00.897611Z", "completed_at": "2024-09-08T17:51:00.994610Z"}, {"name": "execute", "started_at": "2024-09-08T17:51:00.995615Z", "completed_at": "2024-09-08T17:51:19.997613Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 19.102998971939087, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": null, "failures": 0, "unique_id": "test.netsuite_project.test_incremental_load", "compiled": true, "compiled_code": "\n\n\n\n\n\nWITH cte_incremental_table AS (\nSELECT\n\t\"transaction_nsid\",\n  \"transaction_line_nsid\",\n  \"transaction_last_modified_date\",\n  \"transaction_line_last_modified_date\",\n  \"transaction_type\",\n  \"transaction_number\",\n  \"transaction_status\",\n  \"transaction_date\",\n  \"expected_delivery_date\",\n  \"foreign_amount\",\n  \"foreign_currency\",\n  \"quantity\",\n  \"bu_rate\",\n  \"bu_amount\",\n  \"fk_item_nsid\",\n  \"fk_bu_nsid\",\n  \"fk_customer_nsid\"\n\t, CHECKSUM (\"transaction_nsid\",\n  \"transaction_line_nsid\",\n  \"transaction_last_modified_date\",\n  \"transaction_line_last_modified_date\",\n  \"transaction_type\",\n  \"transaction_number\",\n  \"transaction_status\",\n  \"transaction_date\",\n  \"expected_delivery_date\",\n  \"foreign_amount\",\n  \"foreign_currency\",\n  \"quantity\",\n  \"bu_rate\",\n  \"bu_amount\",\n  \"fk_item_nsid\",\n  \"fk_bu_nsid\",\n  \"fk_customer_nsid\" ) AS checksum_result\nFROM \"netsuite\".\"prod_dwh\".\"transaction_with_line\" )\n\n, cte_current_table AS (\nSELECT\n\t\"transaction_nsid\",\n  \"transaction_line_nsid\",\n  \"transaction_last_modified_date\",\n  \"transaction_line_last_modified_date\",\n  \"transaction_type\",\n  \"transaction_number\",\n  \"transaction_status\",\n  \"transaction_date\",\n  \"expected_delivery_date\",\n  \"foreign_amount\",\n  \"foreign_currency\",\n  \"quantity\",\n  \"bu_rate\",\n  \"bu_amount\",\n  \"fk_item_nsid\",\n  \"fk_bu_nsid\",\n  \"fk_customer_nsid\"\n\t, CHECKSUM (\"transaction_nsid\",\n  \"transaction_line_nsid\",\n  \"transaction_last_modified_date\",\n  \"transaction_line_last_modified_date\",\n  \"transaction_type\",\n  \"transaction_number\",\n  \"transaction_status\",\n  \"transaction_date\",\n  \"expected_delivery_date\",\n  \"foreign_amount\",\n  \"foreign_currency\",\n  \"quantity\",\n  \"bu_rate\",\n  \"bu_amount\",\n  \"fk_item_nsid\",\n  \"fk_bu_nsid\",\n  \"fk_customer_nsid\" ) AS checksum_result\nFROM \"netsuite\".\"prod_prp\".\"prep_transaction_with_lines\" )\n\nSELECT \n\tcte_incremental_table.transaction_nsid\t\t\tAS incremental_transaction_nsid\n    , cte_incremental_table.transaction_line_nsid\tAS incremental_transaction_line_nsid\n\t, cte_current_table.transaction_nsid\t\t\tAS current_transaction_nsid\n    , cte_current_table.transaction_line_nsid\t\tAS current_transaction_line_nsid\n\t, CASE \n\t\tWHEN cte_incremental_table.transaction_nsid IS NOT NULL THEN 'Hash present in incremental table exclusively'\n\t\tWHEN cte_current_table.transaction_nsid IS NOT NULL THEN 'Hash present in current table exclusively'\n\tEND \t\t\t\t\t\t\t\t\t\t\tAS control_warning_description\n\t\nFROM cte_incremental_table\nFULL OUTER JOIN cte_current_table\n\tON cte_incremental_table.checksum_result = cte_current_table.checksum_result\nWHERE cte_incremental_table.checksum_result IS NULL\n\tOR cte_current_table.checksum_result IS NULL", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-09-08T17:51:20.005614Z", "completed_at": "2024-09-08T17:51:20.016612Z"}, {"name": "execute", "started_at": "2024-09-08T17:51:20.018614Z", "completed_at": "2024-09-08T17:51:20.594615Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.5939984321594238, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": null, "failures": 0, "unique_id": "test.netsuite_project.unexpected_opportunity_status.a0dda7bad4", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        transaction_status as value_field,\n        count(*) as n_records\n\n    from (select * from \"netsuite\".\"prod_dwh\".\"transaction_with_line\" where transaction_type = 'Opportunity') dbt_subquery\n    group by transaction_status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Under Discussion','Ongoing','Closed - Won','Closed - Lost'\n)\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-09-08T17:51:20.602615Z", "completed_at": "2024-09-08T17:51:20.611611Z"}, {"name": "execute", "started_at": "2024-09-08T17:51:20.612612Z", "completed_at": "2024-09-08T17:51:20.996612Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.397000789642334, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": null, "failures": 0, "unique_id": "test.netsuite_project.unexpected_sales_order_status.5f4b39d9f8", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        transaction_status as value_field,\n        count(*) as n_records\n\n    from (select * from \"netsuite\".\"prod_dwh\".\"transaction_with_line\" where transaction_type = 'Sales Order') dbt_subquery\n    group by transaction_status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Under Discussion','Ongoing','Closed - Won','Closed - Lost'\n)\n\n\n", "relation_name": null}], "elapsed_time": 30.077377796173096, "args": {"defer": false, "print": true, "partial_parse_file_diff": true, "partial_parse": true, "profiles_dir": "C:\\Users\\User\\netsuite_project", "vars": {}, "use_colors_file": true, "target": "prod", "project_dir": "C:\\Users\\User\\netsuite_project", "log_format": "default", "log_level_file": "debug", "log_format_file": "debug", "invocation_command": "dbt test --target prod", "send_anonymous_usage_stats": true, "static_parser": true, "require_explicit_package_overrides_for_builtin_materializations": false, "log_file_max_bytes": 10485760, "printer_width": 80, "which": "test", "warn_error_options": {"include": [], "exclude": []}, "macro_debugging": false, "select": [], "populate_cache": true, "cache_selected_only": false, "strict_mode": false, "quiet": false, "exclude": [], "show_resource_report": false, "version_check": true, "enable_legacy_logger": false, "favor_state": false, "indirect_selection": "eager", "introspect": true, "write_json": true, "log_level": "info", "log_path": "C:\\Users\\User\\netsuite_project\\logs", "use_colors": true}}