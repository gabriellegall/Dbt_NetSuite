{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.7", "generated_at": "2024-10-06T16:22:43.784296Z", "invocation_id": "7429f6c0-b76a-45d8-a775-bae2d3f4e117", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-06T16:22:33.940171Z", "completed_at": "2024-10-06T16:22:33.963969Z"}, {"name": "execute", "started_at": "2024-10-06T16:22:33.964359Z", "completed_at": "2024-10-06T16:22:33.964375Z"}], "thread_id": "Thread-1", "execution_time": 0.02508687973022461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.netsuite_project.dim_date", "compiled": true, "compiled_code": "\n\n\n\nWITH cte_sequence AS (\n  SELECT \n    DATEADD(DAY,value, CAST('2020-01-01' AS DATE)) AS d\n  FROM GENERATE_SERIES ( \n    0\n    , DATEDIFF(DAY, CAST('2020-01-01' AS DATE)\n    , DATEADD(YEAR, 5\n    , \n    CAST('2024-10-06 18:22:25' AS DATE)\n))\n    , 1\n    ) AS gs\n),\n\ncte_core_definition AS (\n  SELECT\n    date_standard                        = CONVERT(DATE,d)\n    , date_int                           = FORMAT(CONVERT(DATE,d), 'yyyyMMdd')\n    , day_of_month_number                = DATEPART(DAY,d)\n    , day_of_week_number                 = DATEPART(WEEKDAY,d)\n    , first_date_of_month                = DATEFROMPARTS(YEAR(d),MONTH(d),1)\n    , last_date_of_month                 = DATEFROMPARTS(YEAR(d),MONTH(d),DAY(EOMONTH(d)))\n    , is_current_day                     = IIF(CONVERT(DATE,d) =  \n    CAST('2024-10-06 18:22:25' AS DATE)\n, 1, 0)\n    , is_above_current_day               = IIF(CONVERT(DATE,d) >  \n    CAST('2024-10-06 18:22:25' AS DATE)\n, 1, 0)\n    , is_above_or_at_current_day         = IIF(CONVERT(DATE,d) >= \n    CAST('2024-10-06 18:22:25' AS DATE)\n, 1, 0)\n    , calendar_year_number               = DATEPART(YEAR,d)\n    , calendar_first_day_of_year         = DATEFROMPARTS(YEAR(d),1,1)\n    , calendar_last_day_of_year          = DATEFROMPARTS(YEAR(d),12,31)\n    , calendar_month_of_year_number      = DATEPART(MONTH,d)\n    , fiscal_year_number                 = CASE WHEN DATEPART(MONTH,d) >= 2 THEN DATEPART(YEAR,d) ELSE DATEPART(YEAR,d) - 1 END\n    , fiscal_first_day_of_year           = DATEFROMPARTS(CASE WHEN DATEPART(MONTH,d) >= 2 THEN DATEPART(YEAR,d) ELSE DATEPART(YEAR,d) - 1 END, 2, 1)\n    , fiscal_last_day_of_year            = DATEADD(DAY, -1, DATEFROMPARTS(CASE WHEN DATEPART(MONTH,d) >= 2 THEN DATEPART(YEAR,d) + 1 ELSE DATEPART(YEAR,d) END, 2, 1))\n    , fiscal_month_of_year_number        = (DATEPART(MONTH,d) + 12 - 2) % 12 + 1\n  FROM cte_sequence\n),\n\ncte_date_dimension AS (\n  SELECT\n    date_standard AS pk_date_standard\n    , date_int     \n    , day_of_month_number   \n    , day_of_week_number   \n    , first_date_of_month  \n    , last_date_of_month       \n    , is_current_day      \n    , is_above_current_day\n    , is_above_or_at_current_day\n    , calendar_year_number    \n    , calendar_first_day_of_year        \n    , calendar_last_day_of_year      \n    , calendar_month_of_year_number   \n    , fiscal_year_number\n    , fiscal_first_day_of_year\n    , fiscal_last_day_of_year\n    , fiscal_month_of_year_number\n    , is_prev_2y_fiscal_year          = IIF(CASE WHEN\n  MONTH(\n    CAST('2024-10-06 18:22:25' AS DATE)\n) >= 2 THEN YEAR(\n    CAST('2024-10-06 18:22:25' AS DATE)\n)\n  ELSE YEAR(\n    CAST('2024-10-06 18:22:25' AS DATE)\n) - 1 \nEND -2 = fiscal_year_number,1,0)\n    , is_prev_1y_fiscal_year          = IIF(CASE WHEN\n  MONTH(\n    CAST('2024-10-06 18:22:25' AS DATE)\n) >= 2 THEN YEAR(\n    CAST('2024-10-06 18:22:25' AS DATE)\n)\n  ELSE YEAR(\n    CAST('2024-10-06 18:22:25' AS DATE)\n) - 1 \nEND -1 = fiscal_year_number,1,0)\n    , is_current_fiscal_year          = IIF(CASE WHEN\n  MONTH(\n    CAST('2024-10-06 18:22:25' AS DATE)\n) >= 2 THEN YEAR(\n    CAST('2024-10-06 18:22:25' AS DATE)\n)\n  ELSE YEAR(\n    CAST('2024-10-06 18:22:25' AS DATE)\n) - 1 \nEND    = fiscal_year_number,1,0)\n    , is_next_1y_fiscal_year          = IIF(CASE WHEN\n  MONTH(\n    CAST('2024-10-06 18:22:25' AS DATE)\n) >= 2 THEN YEAR(\n    CAST('2024-10-06 18:22:25' AS DATE)\n)\n  ELSE YEAR(\n    CAST('2024-10-06 18:22:25' AS DATE)\n) - 1 \nEND +1 = fiscal_year_number,1,0)\n  FROM cte_core_definition\n)\n\nSELECT * FROM cte_date_dimension", "relation_name": "\"netsuite\".\"prod_bus\".\"dim_date\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-06T16:22:33.966282Z", "completed_at": "2024-10-06T16:22:34.021716Z"}, {"name": "execute", "started_at": "2024-10-06T16:22:34.022242Z", "completed_at": "2024-10-06T16:22:34.022251Z"}], "thread_id": "Thread-1", "execution_time": 0.05685067176818848, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.netsuite_project.customer", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-06T16:22:34.024446Z", "completed_at": "2024-10-06T16:22:34.026523Z"}, {"name": "execute", "started_at": "2024-10-06T16:22:34.026898Z", "completed_at": "2024-10-06T16:22:34.026905Z"}], "thread_id": "Thread-1", "execution_time": 0.003478527069091797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.netsuite_project.deleted_records", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-06T16:22:34.028803Z", "completed_at": "2024-10-06T16:22:34.030829Z"}, {"name": "execute", "started_at": "2024-10-06T16:22:34.031194Z", "completed_at": "2024-10-06T16:22:34.031201Z"}], "thread_id": "Thread-1", "execution_time": 0.003255128860473633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.netsuite_project.fx_avg_rate", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-06T16:22:34.033258Z", "completed_at": "2024-10-06T16:22:34.035238Z"}, {"name": "execute", "started_at": "2024-10-06T16:22:34.035611Z", "completed_at": "2024-10-06T16:22:34.035618Z"}], "thread_id": "Thread-1", "execution_time": 0.0034151077270507812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.netsuite_project.item", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-06T16:22:34.037559Z", "completed_at": "2024-10-06T16:22:34.039572Z"}, {"name": "execute", "started_at": "2024-10-06T16:22:34.039933Z", "completed_at": "2024-10-06T16:22:34.039939Z"}], "thread_id": "Thread-1", "execution_time": 0.003223896026611328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.netsuite_project.item_category", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-06T16:22:34.041811Z", "completed_at": "2024-10-06T16:22:34.045012Z"}, {"name": "execute", "started_at": "2024-10-06T16:22:34.045384Z", "completed_at": "2024-10-06T16:22:34.045391Z"}], "thread_id": "Thread-1", "execution_time": 0.004426479339599609, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.netsuite_project.item_pattern", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-06T16:22:34.047351Z", "completed_at": "2024-10-06T16:22:34.049304Z"}, {"name": "execute", "started_at": "2024-10-06T16:22:34.049670Z", "completed_at": "2024-10-06T16:22:34.049677Z"}], "thread_id": "Thread-1", "execution_time": 0.003242015838623047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.netsuite_project.sales_budget", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-06T16:22:34.051616Z", "completed_at": "2024-10-06T16:22:34.053567Z"}, {"name": "execute", "started_at": "2024-10-06T16:22:34.053985Z", "completed_at": "2024-10-06T16:22:34.053992Z"}], "thread_id": "Thread-1", "execution_time": 0.0032188892364501953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.netsuite_project.subsidiary", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-06T16:22:34.055966Z", "completed_at": "2024-10-06T16:22:34.058004Z"}, {"name": "execute", "started_at": "2024-10-06T16:22:34.058376Z", "completed_at": "2024-10-06T16:22:34.058383Z"}], "thread_id": "Thread-1", "execution_time": 0.0033469200134277344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.netsuite_project.transaction", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-06T16:22:34.060306Z", "completed_at": "2024-10-06T16:22:34.062307Z"}, {"name": "execute", "started_at": "2024-10-06T16:22:34.062680Z", "completed_at": "2024-10-06T16:22:34.062686Z"}], "thread_id": "Thread-1", "execution_time": 0.0031871795654296875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.netsuite_project.transactionline", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-06T16:22:34.064699Z", "completed_at": "2024-10-06T16:22:34.066733Z"}, {"name": "execute", "started_at": "2024-10-06T16:22:34.067084Z", "completed_at": "2024-10-06T16:22:34.067090Z"}], "thread_id": "Thread-1", "execution_time": 0.0032854080200195312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.netsuite_project.user_rls", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-06T16:22:34.069069Z", "completed_at": "2024-10-06T16:22:34.074141Z"}, {"name": "execute", "started_at": "2024-10-06T16:22:34.074539Z", "completed_at": "2024-10-06T16:22:34.074546Z"}], "thread_id": "Thread-1", "execution_time": 0.006404876708984375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "snapshot.netsuite_project.historized_customer", "compiled": true, "compiled_code": "\n\n\n\nSELECT\n  cu.customer_nsid\n  , cu.customer_name\n  , cu.customer_tier\nFROM \"netsuite\".\"prod_stg\".\"customer\" cu\n", "relation_name": "\"netsuite\".\"scd\".\"historized_customer\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-06T16:22:34.076557Z", "completed_at": "2024-10-06T16:22:34.760718Z"}, {"name": "execute", "started_at": "2024-10-06T16:22:34.761095Z", "completed_at": "2024-10-06T16:22:34.761107Z"}], "thread_id": "Thread-1", "execution_time": 0.686272144317627, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.netsuite_project.prep_fx_avg_rate_unpivot", "compiled": true, "compiled_code": "\n\nWITH fx_avg_unpivot AS \n(\n    select\n        original_currency,\n        target_currency,\n\n      cast('31/01/2024' as VARCHAR(8000)) as closing_date,\n      cast( \n            [31/01/2024]\n             \n           as float) as fx_rate_original_to_target\n\n    from \"netsuite\".\"prod_stg\".\"fx_avg_rate\"\n\n    union all\n    select\n        original_currency,\n        target_currency,\n\n      cast('29/02/2024' as VARCHAR(8000)) as closing_date,\n      cast( \n            [29/02/2024]\n             \n           as float) as fx_rate_original_to_target\n\n    from \"netsuite\".\"prod_stg\".\"fx_avg_rate\"\n\n    union all\n    select\n        original_currency,\n        target_currency,\n\n      cast('31/03/2024' as VARCHAR(8000)) as closing_date,\n      cast( \n            [31/03/2024]\n             \n           as float) as fx_rate_original_to_target\n\n    from \"netsuite\".\"prod_stg\".\"fx_avg_rate\"\n\n    \n)\n\nSELECT \n        original_currency\n        , target_currency\n        , closing_date\n        , fx_rate_original_to_target\nFROM fx_avg_unpivot\nWHERE target_currency = 'USD'\n\nUNION ALL\n\nSELECT \n        'USD'               AS original_currency\n        , 'USD'             AS target_currency\n        , closing_date\n        , 1                 AS fx_rate_original_to_target\nFROM fx_avg_unpivot\nGROUP BY closing_date", "relation_name": "\"netsuite\".\"prod_prp\".\"prep_fx_avg_rate_unpivot\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-06T16:22:34.764164Z", "completed_at": "2024-10-06T16:22:34.768755Z"}, {"name": "execute", "started_at": "2024-10-06T16:22:34.769169Z", "completed_at": "2024-10-06T16:22:34.769187Z"}], "thread_id": "Thread-1", "execution_time": 0.006177425384521484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "snapshot.netsuite_project.historized_item", "compiled": true, "compiled_code": "\n\n\n\nSELECT\n  it.item_nsid\n  , it.item_name\n  , it.item_code\n  , it.item_type\n  , it.project_code\n  , it_cat.item_category\n  , it_cat.item_sub_category\n  , it_pat.item_pattern\n  \nFROM \"netsuite\".\"prod_stg\".\"item\" it\n  LEFT OUTER JOIN \"netsuite\".\"prod_stg\".\"item_category\" it_cat \n    ON it.item_category_nsid = it_cat.item_category_nsid\n  LEFT OUTER JOIN \"netsuite\".\"prod_stg\".\"item_pattern\" it_pat\n    ON it.item_pattern_nsid = it_pat.item_pattern_nsid\n", "relation_name": "\"netsuite\".\"scd\".\"historized_item\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-06T16:22:34.771242Z", "completed_at": "2024-10-06T16:22:34.774843Z"}, {"name": "execute", "started_at": "2024-10-06T16:22:34.775219Z", "completed_at": "2024-10-06T16:22:34.775225Z"}], "thread_id": "Thread-1", "execution_time": 0.004835844039916992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "snapshot.netsuite_project.historized_bu", "compiled": true, "compiled_code": "\n\n\n\nSELECT\n  bu.bu_nsid\n  , bu.bu_code\n  , bu.bu_country_code\n  , bu.bu_currency\n  , bu.bu_legal_name\n  , bu.bu_commercial_group\nFROM \"netsuite\".\"prod_stg\".\"subsidiary\" bu\n", "relation_name": "\"netsuite\".\"scd\".\"historized_bu\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-06T16:22:34.777270Z", "completed_at": "2024-10-06T16:22:34.781181Z"}, {"name": "execute", "started_at": "2024-10-06T16:22:34.781569Z", "completed_at": "2024-10-06T16:22:34.781576Z"}], "thread_id": "Thread-1", "execution_time": 0.005249977111816406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.netsuite_project.prep_delta_records", "compiled": true, "compiled_code": "\n\nSELECT transaction_nsid, MAX ( transaction_line_last_modified_date ) AS transaction_global_last_modified_date\nFROM \n( \n    SELECT transaction_nsid, transaction_line_last_modified_date FROM \"netsuite\".\"prod_stg\".\"transactionline\"\n    UNION ALL\n    SELECT transaction_nsid, transaction_last_modified_date      FROM \"netsuite\".\"prod_stg\".\"transaction\"\n) all_updates\nGROUP BY transaction_nsid", "relation_name": "\"netsuite\".\"prod_prp\".\"prep_delta_records\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-06T16:22:34.783464Z", "completed_at": "2024-10-06T16:22:34.794262Z"}, {"name": "execute", "started_at": "2024-10-06T16:22:34.794647Z", "completed_at": "2024-10-06T16:22:34.794654Z"}], "thread_id": "Thread-1", "execution_time": 0.012041091918945312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.netsuite_project.prep_transaction_with_lines", "compiled": true, "compiled_code": "\n\nSELECT \n    t.transaction_nsid                                                                              AS transaction_nsid\n    , tl.transaction_line_nsid                                                                      AS transaction_line_nsid\n    , t.transaction_last_modified_date\n    , tl.transaction_line_last_modified_date\n    , t.transaction_type\n    , t.transaction_number\n    , t.transaction_status\n    , CAST(t.transaction_date AS DATETIME2)                                                         AS transaction_date\n    , t.expected_delivery_date\n    , tl.foreign_amount\n    , tl.foreign_currency\n    , tl.quantity\n    , tl.bu_rate\n    , tl.foreign_amount * tl.bu_rate                                                                AS bu_amount \n    , \n    lower(convert(varchar(50), hashbytes('md5', coalesce(convert(varchar(8000), \n        concat(coalesce(cast(tl.item_nsid as VARCHAR(8000)), '_dbt_utils_surrogate_key_null_'), '')), '')), 2))\n                                    AS fk_item_nsid\n    , \n    lower(convert(varchar(50), hashbytes('md5', coalesce(convert(varchar(8000), \n        concat(coalesce(cast(t.bu_nsid as VARCHAR(8000)), '_dbt_utils_surrogate_key_null_'), '')), '')), 2))\n                                       AS fk_bu_nsid\n    , \n    lower(convert(varchar(50), hashbytes('md5', coalesce(convert(varchar(8000), \n        concat(coalesce(cast(t.customer_nsid as VARCHAR(8000)), '_dbt_utils_surrogate_key_null_'), '')), '')), 2))\n                                 AS fk_customer_nsid\n    , \n    CAST('2024-10-06 18:22:25' AS DATETIME2)\n                                                              AS dbt_load_datetime\n    , '7429f6c0-b76a-45d8-a775-bae2d3f4e117'                                                                     AS dbt_run_id\n\nFROM \"netsuite\".\"prod_stg\".\"transaction\" t\n    LEFT OUTER JOIN \"netsuite\".\"prod_stg\".\"transactionline\" tl\n    ON t.transaction_nsid = tl.transaction_nsid", "relation_name": "\"netsuite\".\"prod_prp\".\"prep_transaction_with_lines\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-06T16:22:34.796689Z", "completed_at": "2024-10-06T16:22:34.800181Z"}, {"name": "execute", "started_at": "2024-10-06T16:22:34.800594Z", "completed_at": "2024-10-06T16:22:34.800601Z"}], "thread_id": "Thread-1", "execution_time": 0.004876852035522461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "snapshot.netsuite_project.historized_user_rls", "compiled": true, "compiled_code": "\n\n\n\nSELECT\n  user_email\n  , authorized_bu_code\n  , authorized_customer_name\n  , authorized_item_type\n  \nFROM \"netsuite\".\"prod_stg\".\"user_rls\"\n", "relation_name": "\"netsuite\".\"scd\".\"historized_user_rls\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-06T16:22:34.802571Z", "completed_at": "2024-10-06T16:22:35.479917Z"}, {"name": "execute", "started_at": "2024-10-06T16:22:35.480287Z", "completed_at": "2024-10-06T16:22:35.480298Z"}], "thread_id": "Thread-1", "execution_time": 0.679431676864624, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.netsuite_project.dim_customer", "compiled": true, "compiled_code": "\n\n\n\n    \n\n    \n    \n    \n\n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n\n    \n        \n    \n        \n            \n                    \n        \n    \n        \n            \n                    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n\n    SELECT \n        hist.customer_name AS hist_customer_name, hist.customer_tier AS hist_customer_tier\n        , live.customer_name AS live_customer_name, live.customer_tier AS live_customer_tier\n        , \n    lower(convert(varchar(50), hashbytes('md5', coalesce(convert(varchar(8000), \n        concat(coalesce(cast(hist.customer_nsid as VARCHAR(8000)), '_dbt_utils_surrogate_key_null_'), '')), '')), 2))\n AS pk_customer_nsid\n        , hist.customer_nsid, hist.dbt_scd_id, hist.dbt_updated_at, hist.dbt_valid_from, hist.dbt_valid_to\n        , IIF ( ROW_NUMBER() OVER ( PARTITION BY hist.customer_nsid ORDER BY hist.dbt_valid_from ) = 1\n            , CAST('1900-01-01' AS DATETIME2)\n            , hist.dbt_valid_from )                                                             AS scd_valid_from_fill_date\n        , COALESCE(hist.dbt_valid_to, cast('9999-12-31' AS DATETIME2))      AS scd_valid_to_fill_date\n        , ROW_NUMBER() OVER ( PARTITION BY hist.customer_nsid ORDER BY hist.dbt_valid_from ) AS version_number\n    FROM  \n        \"netsuite\".\"scd\".\"historized_customer\" AS hist\n        LEFT OUTER JOIN \n        ( SELECT * FROM \"netsuite\".\"scd\".\"historized_customer\" WHERE dbt_valid_to IS NULL ) live\n            ON live.customer_nsid = hist.customer_nsid\n\n", "relation_name": "\"netsuite\".\"prod_bus\".\"dim_customer\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-06T16:22:35.483105Z", "completed_at": "2024-10-06T16:22:35.487916Z"}, {"name": "execute", "started_at": "2024-10-06T16:22:35.488278Z", "completed_at": "2024-10-06T16:22:35.488285Z"}], "thread_id": "Thread-1", "execution_time": 0.006029844284057617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.netsuite_project.fact_fx_avg_rate_dated", "compiled": true, "compiled_code": "\n\nSELECT\n    t1.original_currency\n    , t1.closing_date\n    , t1.fx_rate_original_to_target                                 AS fx_rate_original_to_usd\n    , t1.fx_rate_original_to_target / t2.fx_rate_original_to_target AS fx_rate_original_to_dynamic\n    , 'EUR'                       AS dynamic_target_currency\nFROM\n    \"netsuite\".\"prod_prp\".\"prep_fx_avg_rate_unpivot\" t1\nLEFT OUTER JOIN \n    (SELECT fx_rate_original_to_target, closing_date FROM \"netsuite\".\"prod_prp\".\"prep_fx_avg_rate_unpivot\" WHERE original_currency = 'EUR' ) t2 ON t1.closing_date = t2.closing_date", "relation_name": "\"netsuite\".\"prod_bus\".\"fact_fx_avg_rate_dated\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-06T16:22:35.490176Z", "completed_at": "2024-10-06T16:22:35.495804Z"}, {"name": "execute", "started_at": "2024-10-06T16:22:35.496160Z", "completed_at": "2024-10-06T16:22:35.496167Z"}], "thread_id": "Thread-1", "execution_time": 0.006819009780883789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.netsuite_project.fact_fx_avg_rate_latest", "compiled": true, "compiled_code": "\n\nWITH flag_latest_rate AS \n(\n    SELECT \n        *     \n        , ROW_NUMBER () OVER (PARTITION BY original_currency ORDER BY closing_date DESC) AS row_id\n    FROM \"netsuite\".\"prod_prp\".\"prep_fx_avg_rate_unpivot\"\n),\n\nfilter_latest_rate AS \n(\n    SELECT\n        *\n    FROM flag_latest_rate \n    WHERE row_id = 1\n)\n\nSELECT\n    t1.original_currency\n    , t1.fx_rate_original_to_target                                 AS fx_rate_original_to_usd\n    , t1.fx_rate_original_to_target / t2.fx_rate_original_to_target AS fx_rate_original_to_dynamic\n    , 'EUR'                       AS dynamic_target_currency\nFROM\n    filter_latest_rate t1\nCROSS JOIN \n    (SELECT fx_rate_original_to_target FROM filter_latest_rate WHERE original_currency = 'EUR' ) t2", "relation_name": "\"netsuite\".\"prod_bus\".\"fact_fx_avg_rate_latest\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-06T16:22:35.498036Z", "completed_at": "2024-10-06T16:22:36.177506Z"}, {"name": "execute", "started_at": "2024-10-06T16:22:36.177895Z", "completed_at": "2024-10-06T16:22:36.177909Z"}], "thread_id": "Thread-1", "execution_time": 0.6815030574798584, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.netsuite_project.dim_item", "compiled": true, "compiled_code": "\n\n\n\n    \n\n    \n    \n    \n\n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n\n    \n        \n    \n        \n            \n                    \n        \n    \n        \n            \n                    \n        \n    \n        \n            \n                    \n        \n    \n        \n            \n                    \n        \n    \n        \n            \n                    \n        \n    \n        \n            \n                    \n        \n    \n        \n            \n                    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n\n    SELECT \n        hist.item_name AS hist_item_name, hist.item_code AS hist_item_code, hist.item_type AS hist_item_type, hist.project_code AS hist_project_code, hist.item_category AS hist_item_category, hist.item_sub_category AS hist_item_sub_category, hist.item_pattern AS hist_item_pattern\n        , live.item_name AS live_item_name, live.item_code AS live_item_code, live.item_type AS live_item_type, live.project_code AS live_project_code, live.item_category AS live_item_category, live.item_sub_category AS live_item_sub_category, live.item_pattern AS live_item_pattern\n        , \n    lower(convert(varchar(50), hashbytes('md5', coalesce(convert(varchar(8000), \n        concat(coalesce(cast(hist.item_nsid as VARCHAR(8000)), '_dbt_utils_surrogate_key_null_'), '')), '')), 2))\n AS pk_item_nsid\n        , hist.item_nsid, hist.dbt_scd_id, hist.dbt_updated_at, hist.dbt_valid_from, hist.dbt_valid_to\n        , IIF ( ROW_NUMBER() OVER ( PARTITION BY hist.item_nsid ORDER BY hist.dbt_valid_from ) = 1\n            , CAST('1900-01-01' AS DATETIME2)\n            , hist.dbt_valid_from )                                                             AS scd_valid_from_fill_date\n        , COALESCE(hist.dbt_valid_to, cast('9999-12-31' AS DATETIME2))      AS scd_valid_to_fill_date\n        , ROW_NUMBER() OVER ( PARTITION BY hist.item_nsid ORDER BY hist.dbt_valid_from ) AS version_number\n    FROM  \n        \"netsuite\".\"scd\".\"historized_item\" AS hist\n        LEFT OUTER JOIN \n        ( SELECT * FROM \"netsuite\".\"scd\".\"historized_item\" WHERE dbt_valid_to IS NULL ) live\n            ON live.item_nsid = hist.item_nsid\n\n", "relation_name": "\"netsuite\".\"prod_bus\".\"dim_item\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-06T16:22:36.180677Z", "completed_at": "2024-10-06T16:22:36.861033Z"}, {"name": "execute", "started_at": "2024-10-06T16:22:36.861430Z", "completed_at": "2024-10-06T16:22:36.861443Z"}], "thread_id": "Thread-1", "execution_time": 0.68245530128479, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.netsuite_project.dim_bu", "compiled": true, "compiled_code": "\n\n\n\n    \n\n    \n    \n    \n\n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n\n    \n        \n    \n        \n            \n                    \n        \n    \n        \n            \n                    \n        \n    \n        \n            \n                    \n        \n    \n        \n            \n                    \n        \n    \n        \n            \n                    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n\n    SELECT \n        hist.bu_code AS hist_bu_code, hist.bu_country_code AS hist_bu_country_code, hist.bu_currency AS hist_bu_currency, hist.bu_legal_name AS hist_bu_legal_name, hist.bu_commercial_group AS hist_bu_commercial_group\n        , live.bu_code AS live_bu_code, live.bu_country_code AS live_bu_country_code, live.bu_currency AS live_bu_currency, live.bu_legal_name AS live_bu_legal_name, live.bu_commercial_group AS live_bu_commercial_group\n        , \n    lower(convert(varchar(50), hashbytes('md5', coalesce(convert(varchar(8000), \n        concat(coalesce(cast(hist.bu_nsid as VARCHAR(8000)), '_dbt_utils_surrogate_key_null_'), '')), '')), 2))\n AS pk_bu_nsid\n        , hist.bu_nsid, hist.dbt_scd_id, hist.dbt_updated_at, hist.dbt_valid_from, hist.dbt_valid_to\n        , IIF ( ROW_NUMBER() OVER ( PARTITION BY hist.bu_nsid ORDER BY hist.dbt_valid_from ) = 1\n            , CAST('1900-01-01' AS DATETIME2)\n            , hist.dbt_valid_from )                                                             AS scd_valid_from_fill_date\n        , COALESCE(hist.dbt_valid_to, cast('9999-12-31' AS DATETIME2))      AS scd_valid_to_fill_date\n        , ROW_NUMBER() OVER ( PARTITION BY hist.bu_nsid ORDER BY hist.dbt_valid_from ) AS version_number\n    FROM  \n        \"netsuite\".\"scd\".\"historized_bu\" AS hist\n        LEFT OUTER JOIN \n        ( SELECT * FROM \"netsuite\".\"scd\".\"historized_bu\" WHERE dbt_valid_to IS NULL ) live\n            ON live.bu_nsid = hist.bu_nsid\n\n", "relation_name": "\"netsuite\".\"prod_bus\".\"dim_bu\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-06T16:22:36.864092Z", "completed_at": "2024-10-06T16:22:36.874134Z"}, {"name": "execute", "started_at": "2024-10-06T16:22:36.874549Z", "completed_at": "2024-10-06T16:22:36.874556Z"}], "thread_id": "Thread-1", "execution_time": 0.011326074600219727, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.netsuite_project.transaction_with_line", "compiled": true, "compiled_code": "\n\nSELECT * FROM \"netsuite\".\"prod_prp\".\"prep_transaction_with_lines\"\n\n\n-- depends_on: \"netsuite\".\"prod_prp\".\"prep_delta_records\"\n\n    WHERE transaction_nsid IN\n    ( \n        SELECT \n            transaction_nsid \n        FROM \"netsuite\".\"prod_prp\".\"prep_delta_records\"  \n        WHERE \n            CAST ( transaction_global_last_modified_date AS DATE ) >=\n                \n                GREATEST (\n                      ( SELECT MAX ( CAST ( incremental_date.transaction_last_modified_date AS DATE ) ) FROM \"netsuite\".\"prod_dwh\".\"transaction_with_line\" as incremental_date )\n                    , ( SELECT MAX ( CAST ( incremental_date.transaction_line_last_modified_date AS DATE ) ) FROM \"netsuite\".\"prod_dwh\".\"transaction_with_line\" as incremental_date )\n                )\n    )           \n", "relation_name": "\"netsuite\".\"prod_dwh\".\"transaction_with_line\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-06T16:22:36.876706Z", "completed_at": "2024-10-06T16:22:36.880424Z"}, {"name": "execute", "started_at": "2024-10-06T16:22:36.880791Z", "completed_at": "2024-10-06T16:22:36.880798Z"}], "thread_id": "Thread-1", "execution_time": 0.0051419734954833984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.netsuite_project.prep_rls_normalize", "compiled": true, "compiled_code": "\n\nWITH cte_row_id AS (\nSELECT \n  *\n  , ROW_NUMBER() OVER (PARTITION BY user_email ORDER BY user_email) as row_id\nFROM \"netsuite\".\"scd\".\"historized_user_rls\"\nWHERE dbt_valid_to IS NULL\n) \n\n, cte_authorized_bu_code AS (\nSELECT\n  user_email,\n  row_id,\n  LTRIM(RTRIM(value)) AS authorized_bu_code\nFROM cte_row_id\nCROSS APPLY STRING_SPLIT(authorized_bu_code, ',') AS authorized_bu_code\n)\n\n, cte_authorized_customer_name AS (\nSELECT\n  user_email,\n  row_id,\n  LTRIM(RTRIM(value)) AS authorized_customer_name\nFROM cte_row_id\nCROSS APPLY STRING_SPLIT(authorized_customer_name, ',') AS authorized_customer_name\n)\n\n, cte_authorized_item_type AS (\nSELECT\n  user_email,\n  row_id,\n  LTRIM(RTRIM(value)) AS authorized_item_type\nFROM cte_row_id\nCROSS APPLY STRING_SPLIT(authorized_item_type, ',') AS authorized_item_type\n)\n\nSELECT \n\tbu.user_email\n  , bu.row_id\n\t, bu.authorized_bu_code\n\t, cust.authorized_customer_name\n  , it.authorized_item_type\nFROM cte_authorized_bu_code bu\nINNER JOIN cte_authorized_customer_name cust \n    ON bu.user_email = cust.user_email\n    AND bu.row_id = cust.row_id\nINNER JOIN cte_authorized_item_type it \n    ON bu.user_email = it.user_email\n    AND bu.row_id = it.row_id", "relation_name": "\"netsuite\".\"prod_prp\".\"prep_rls_normalize\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-06T16:22:36.882681Z", "completed_at": "2024-10-06T16:22:36.886163Z"}, {"name": "execute", "started_at": "2024-10-06T16:22:36.886542Z", "completed_at": "2024-10-06T16:22:36.886549Z"}], "thread_id": "Thread-1", "execution_time": 0.004782199859619141, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.netsuite_project.prep_dim_bu_alternate_key_bu_code", "compiled": true, "compiled_code": "\n\nWITH dim_business_unit_bu_code_id AS \n(\n    SELECT \n        *\n        , ROW_NUMBER() OVER(PARTITION BY live_bu_code ORDER BY dbt_updated_at DESC) AS bu_code_id_key\n    FROM \"netsuite\".\"prod_bus\".\"dim_bu\"\n)\n\nSELECT * FROM dim_business_unit_bu_code_id WHERE bu_code_id_key = 1", "relation_name": "\"netsuite\".\"prod_prp\".\"prep_dim_bu_alternate_key_bu_code\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-06T16:22:36.888502Z", "completed_at": "2024-10-06T16:22:37.584465Z"}, {"name": "execute", "started_at": "2024-10-06T16:22:37.584846Z", "completed_at": "2024-10-06T16:22:37.584858Z"}], "thread_id": "Thread-1", "execution_time": 0.6980047225952148, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.netsuite_project.historized_transaction_with_line", "compiled": true, "compiled_code": "\n\nSELECT\n    \n    \"transaction_nsid\",\n  \"transaction_line_nsid\",\n  \"transaction_last_modified_date\",\n  \"transaction_line_last_modified_date\",\n  \"transaction_type\",\n  \"transaction_number\",\n  \"transaction_status\",\n  \"transaction_date\",\n  \"expected_delivery_date\",\n  \"foreign_amount\",\n  \"foreign_currency\",\n  \"quantity\",\n  \"bu_rate\",\n  \"bu_amount\",\n  \"fk_item_nsid\",\n  \"fk_bu_nsid\",\n  \"fk_customer_nsid\"\n    , \n    EOMONTH('2024-10-06', -1)\n AS dbt_functional_snapshot_date     \n    , \n    CAST('2024-10-06 18:22:25' AS DATETIME2)\n  AS dbt_load_datetime\n    , '7429f6c0-b76a-45d8-a775-bae2d3f4e117'         AS dbt_run_id         \nFROM \"netsuite\".\"prod_dwh\".\"transaction_with_line\" t\n\n\nWHERE t.transaction_type IN ( 'Opportunity', 'Invoice', 'Sales Order' )\n\n\n    \n    AND \n    EOMONTH('2024-10-06', -1)\n > ( SELECT MAX ( incremental_date.dbt_functional_snapshot_date ) FROM \"netsuite\".\"prod_dwh\".\"historized_transaction_with_line\" as incremental_date )\n", "relation_name": "\"netsuite\".\"prod_dwh\".\"historized_transaction_with_line\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-06T16:22:37.587846Z", "completed_at": "2024-10-06T16:22:37.593451Z"}, {"name": "execute", "started_at": "2024-10-06T16:22:37.593808Z", "completed_at": "2024-10-06T16:22:37.593815Z"}], "thread_id": "Thread-1", "execution_time": 0.007016181945800781, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.netsuite_project.prep_transaction_with_lines_for_union", "compiled": true, "compiled_code": "\n\nSELECT \n    *\n    , \n    CAST('2024-10-06 18:22:25' AS DATETIME2)\n AS dbt_functional_snapshot_date \n    \nFROM \"netsuite\".\"prod_dwh\".\"transaction_with_line\" t", "relation_name": "\"netsuite\".\"prod_prp\".\"prep_transaction_with_lines_for_union\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-06T16:22:37.595838Z", "completed_at": "2024-10-06T16:22:38.628589Z"}, {"name": "execute", "started_at": "2024-10-06T16:22:38.628961Z", "completed_at": "2024-10-06T16:22:38.628973Z"}], "thread_id": "Thread-1", "execution_time": 1.0348567962646484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.netsuite_project.test_incremental_load", "compiled": true, "compiled_code": "\n\n\n\n\n\nWITH cte_incremental_table AS (\nSELECT\n\t\"transaction_nsid\",\n  \"transaction_line_nsid\",\n  \"transaction_last_modified_date\",\n  \"transaction_line_last_modified_date\",\n  \"transaction_type\",\n  \"transaction_number\",\n  \"transaction_status\",\n  \"transaction_date\",\n  \"expected_delivery_date\",\n  \"foreign_amount\",\n  \"foreign_currency\",\n  \"quantity\",\n  \"bu_rate\",\n  \"bu_amount\",\n  \"fk_item_nsid\",\n  \"fk_bu_nsid\",\n  \"fk_customer_nsid\"\n\t, CHECKSUM (\"transaction_nsid\",\n  \"transaction_line_nsid\",\n  \"transaction_last_modified_date\",\n  \"transaction_line_last_modified_date\",\n  \"transaction_type\",\n  \"transaction_number\",\n  \"transaction_status\",\n  \"transaction_date\",\n  \"expected_delivery_date\",\n  \"foreign_amount\",\n  \"foreign_currency\",\n  \"quantity\",\n  \"bu_rate\",\n  \"bu_amount\",\n  \"fk_item_nsid\",\n  \"fk_bu_nsid\",\n  \"fk_customer_nsid\" ) AS checksum_result\nFROM \"netsuite\".\"prod_dwh\".\"transaction_with_line\" )\n\n, cte_current_table AS (\nSELECT\n\t\"transaction_nsid\",\n  \"transaction_line_nsid\",\n  \"transaction_last_modified_date\",\n  \"transaction_line_last_modified_date\",\n  \"transaction_type\",\n  \"transaction_number\",\n  \"transaction_status\",\n  \"transaction_date\",\n  \"expected_delivery_date\",\n  \"foreign_amount\",\n  \"foreign_currency\",\n  \"quantity\",\n  \"bu_rate\",\n  \"bu_amount\",\n  \"fk_item_nsid\",\n  \"fk_bu_nsid\",\n  \"fk_customer_nsid\"\n\t, CHECKSUM (\"transaction_nsid\",\n  \"transaction_line_nsid\",\n  \"transaction_last_modified_date\",\n  \"transaction_line_last_modified_date\",\n  \"transaction_type\",\n  \"transaction_number\",\n  \"transaction_status\",\n  \"transaction_date\",\n  \"expected_delivery_date\",\n  \"foreign_amount\",\n  \"foreign_currency\",\n  \"quantity\",\n  \"bu_rate\",\n  \"bu_amount\",\n  \"fk_item_nsid\",\n  \"fk_bu_nsid\",\n  \"fk_customer_nsid\" ) AS checksum_result\nFROM \"netsuite\".\"prod_prp\".\"prep_transaction_with_lines\" )\n\nSELECT \n\tcte_incremental_table.transaction_nsid\t\t\tAS incremental_transaction_nsid\n    , cte_incremental_table.transaction_line_nsid\tAS incremental_transaction_line_nsid\n\t, cte_current_table.transaction_nsid\t\t\tAS current_transaction_nsid\n    , cte_current_table.transaction_line_nsid\t\tAS current_transaction_line_nsid\n\t, CASE \n\t\tWHEN cte_incremental_table.transaction_nsid IS NOT NULL THEN 'Hash present in incremental table exclusively'\n\t\tWHEN cte_current_table.transaction_nsid IS NOT NULL THEN 'Hash present in current table exclusively'\n\tEND \t\t\t\t\t\t\t\t\t\t\tAS control_warning_description\n\t\nFROM cte_incremental_table\nFULL OUTER JOIN cte_current_table\n\tON cte_incremental_table.checksum_result = cte_current_table.checksum_result\nWHERE cte_incremental_table.checksum_result IS NULL\n\tOR cte_current_table.checksum_result IS NULL", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-06T16:22:38.631725Z", "completed_at": "2024-10-06T16:22:38.637878Z"}, {"name": "execute", "started_at": "2024-10-06T16:22:38.638238Z", "completed_at": "2024-10-06T16:22:38.638245Z"}], "thread_id": "Thread-1", "execution_time": 0.007396221160888672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.netsuite_project.unexpected_opportunity_status.a0dda7bad4", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        transaction_status as value_field,\n        count(*) as n_records\n\n    from (select * from \"netsuite\".\"prod_dwh\".\"transaction_with_line\" where transaction_type = 'Opportunity') dbt_subquery\n    group by transaction_status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Under Discussion','Ongoing','Closed - Won','Closed - Lost'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-06T16:22:38.640138Z", "completed_at": "2024-10-06T16:22:38.645956Z"}, {"name": "execute", "started_at": "2024-10-06T16:22:38.646312Z", "completed_at": "2024-10-06T16:22:38.646335Z"}], "thread_id": "Thread-1", "execution_time": 0.007037639617919922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.netsuite_project.unexpected_sales_order_status.5f4b39d9f8", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        transaction_status as value_field,\n        count(*) as n_records\n\n    from (select * from \"netsuite\".\"prod_dwh\".\"transaction_with_line\" where transaction_type = 'Sales Order') dbt_subquery\n    group by transaction_status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Under Discussion','Ongoing','Closed - Won','Closed - Lost'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-06T16:22:38.648176Z", "completed_at": "2024-10-06T16:22:39.328914Z"}, {"name": "execute", "started_at": "2024-10-06T16:22:39.329293Z", "completed_at": "2024-10-06T16:22:39.329305Z"}], "thread_id": "Thread-1", "execution_time": 0.682729959487915, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.netsuite_project.prep_budget_for_union", "compiled": true, "compiled_code": "\n\nWITH consolidate_data AS \n\n(\n    SELECT\n        'Budget'                                                                                     AS transaction_type  \n        , budget_year\n        , budget_version\n        \n        , customer_name                                                                              AS live_customer_name\n        , customer_name                                                                              AS hist_customer_name\n        \n        , \"hist_bu_code\",\n  \"hist_bu_country_code\",\n  \"hist_bu_currency\",\n  \"hist_bu_legal_name\",\n  \"hist_bu_commercial_group\",\n  \"live_bu_code\",\n  \"live_bu_country_code\",\n  \"live_bu_currency\",\n  \"live_bu_legal_name\",\n  \"live_bu_commercial_group\",\n  \"pk_bu_nsid\",\n  \"bu_nsid\"\n        , sales_amount_bu_currency                                                                   AS budget_sales_amount_bu_currency\n        , budget_date                                                                                AS calculation_date\n        , COALESCE( fx_dated.fx_rate_original_to_usd, fx_latest.fx_rate_original_to_usd )            AS fx_rate_original_to_usd\n        , COALESCE( fx_dated.fx_rate_original_to_dynamic, fx_latest.fx_rate_original_to_dynamic )    AS fx_rate_original_to_dynamic\n        , 'EUR'                                                    AS dynamic_target_currency\n\n    FROM \"netsuite\".\"prod_stg\".\"sales_budget\" bud\n    LEFT OUTER JOIN \"netsuite\".\"prod_bus\".\"fact_fx_avg_rate_latest\" fx_latest\n        ON bud.bu_currency = fx_latest.original_currency\n    LEFT OUTER JOIN \"netsuite\".\"prod_bus\".\"fact_fx_avg_rate_dated\" fx_dated\n        ON bud.bu_currency = fx_dated.original_currency\n        AND EOMONTH(bud.budget_date) = fx_dated.closing_date\n    LEFT OUTER JOIN \"netsuite\".\"prod_prp\".\"prep_dim_bu_alternate_key_bu_code\" bu\n        ON bu.live_bu_code = bud.bu_code\n)\n\nSELECT\n    *\n    , fx_rate_original_to_usd       * budget_sales_amount_bu_currency AS budget_sales_amount_usd_currency\n    , fx_rate_original_to_dynamic   * budget_sales_amount_bu_currency AS budget_sales_amount_dynamic_currency\nFROM consolidate_data", "relation_name": "\"netsuite\".\"prod_prp\".\"prep_budget_for_union\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-06T16:22:39.332350Z", "completed_at": "2024-10-06T16:22:39.338472Z"}, {"name": "execute", "started_at": "2024-10-06T16:22:39.338841Z", "completed_at": "2024-10-06T16:22:39.338848Z"}], "thread_id": "Thread-1", "execution_time": 0.007555723190307617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.netsuite_project.dbt_utils_unique_combination_of_columns_historized_transaction_with_line_var_dbt_snapshot_col_name___transaction_nsid__transaction_line_nsid.8021ab7f24", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        dbt_functional_snapshot_date, transaction_nsid, transaction_line_nsid\n    from \"netsuite\".\"prod_dwh\".\"historized_transaction_with_line\"\n    group by dbt_functional_snapshot_date, transaction_nsid, transaction_line_nsid\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-06T16:22:39.340782Z", "completed_at": "2024-10-06T16:22:39.351904Z"}, {"name": "execute", "started_at": "2024-10-06T16:22:39.352270Z", "completed_at": "2024-10-06T16:22:39.352277Z"}], "thread_id": "Thread-1", "execution_time": 0.012389898300170898, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.netsuite_project.not_null_historized_transaction_with_line_transaction_line_nsid.c46e56a2e1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect transaction_line_nsid\nfrom \"netsuite\".\"prod_dwh\".\"historized_transaction_with_line\"\nwhere transaction_line_nsid is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-06T16:22:39.354173Z", "completed_at": "2024-10-06T16:22:39.358604Z"}, {"name": "execute", "started_at": "2024-10-06T16:22:39.358961Z", "completed_at": "2024-10-06T16:22:39.358968Z"}], "thread_id": "Thread-1", "execution_time": 0.005629539489746094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.netsuite_project.not_null_historized_transaction_with_line_transaction_nsid.4b11b8bce6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect transaction_nsid\nfrom \"netsuite\".\"prod_dwh\".\"historized_transaction_with_line\"\nwhere transaction_nsid is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-06T16:22:39.360892Z", "completed_at": "2024-10-06T16:22:40.280014Z"}, {"name": "execute", "started_at": "2024-10-06T16:22:40.280415Z", "completed_at": "2024-10-06T16:22:40.280426Z"}], "thread_id": "Thread-1", "execution_time": 0.9211435317993164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.netsuite_project.fact_all_transactions_with_line", "compiled": true, "compiled_code": "\n\nWITH union_current_and_snapshot AS \n(\n    \n\n        (\n            select\n                cast('\"netsuite\".\"prod_prp\".\"prep_transaction_with_lines_for_union\"' as VARCHAR(8000)) as _dbt_source_relation,\n\n                \n                    cast(\"transaction_nsid\" as int) as \"transaction_nsid\" ,\n                    cast(\"transaction_line_nsid\" as int) as \"transaction_line_nsid\" ,\n                    cast(\"transaction_last_modified_date\" as varchar(16)) as \"transaction_last_modified_date\" ,\n                    cast(\"transaction_line_last_modified_date\" as varchar(16)) as \"transaction_line_last_modified_date\" ,\n                    cast(\"transaction_type\" as varchar(16)) as \"transaction_type\" ,\n                    cast(\"transaction_number\" as varchar(16)) as \"transaction_number\" ,\n                    cast(\"transaction_status\" as varchar(16)) as \"transaction_status\" ,\n                    cast(\"transaction_date\" as datetime2) as \"transaction_date\" ,\n                    cast(\"expected_delivery_date\" as varchar(16)) as \"expected_delivery_date\" ,\n                    cast(\"foreign_amount\" as int) as \"foreign_amount\" ,\n                    cast(\"foreign_currency\" as varchar(16)) as \"foreign_currency\" ,\n                    cast(\"quantity\" as int) as \"quantity\" ,\n                    cast(\"bu_rate\" as float) as \"bu_rate\" ,\n                    cast(\"bu_amount\" as float) as \"bu_amount\" ,\n                    cast(\"fk_item_nsid\" as varchar(50)) as \"fk_item_nsid\" ,\n                    cast(\"fk_bu_nsid\" as varchar(50)) as \"fk_bu_nsid\" ,\n                    cast(\"fk_customer_nsid\" as varchar(50)) as \"fk_customer_nsid\" ,\n                    cast(\"dbt_load_datetime\" as datetime2) as \"dbt_load_datetime\" ,\n                    cast(\"dbt_run_id\" as varchar(36)) as \"dbt_run_id\" ,\n                    cast(\"dbt_functional_snapshot_date\" as datetime2) as \"dbt_functional_snapshot_date\" \n\n            from \"netsuite\".\"prod_prp\".\"prep_transaction_with_lines_for_union\"\n\n            where YEAR(transaction_date) >= '2023' AND transaction_type IN ('Opportunity', 'Invoice', 'Sales Order', 'Journal Entry')\n        )\n\n        union all\n        \n\n        (\n            select\n                cast('\"netsuite\".\"prod_dwh\".\"historized_transaction_with_line\"' as VARCHAR(8000)) as _dbt_source_relation,\n\n                \n                    cast(\"transaction_nsid\" as int) as \"transaction_nsid\" ,\n                    cast(\"transaction_line_nsid\" as int) as \"transaction_line_nsid\" ,\n                    cast(\"transaction_last_modified_date\" as varchar(16)) as \"transaction_last_modified_date\" ,\n                    cast(\"transaction_line_last_modified_date\" as varchar(16)) as \"transaction_line_last_modified_date\" ,\n                    cast(\"transaction_type\" as varchar(16)) as \"transaction_type\" ,\n                    cast(\"transaction_number\" as varchar(16)) as \"transaction_number\" ,\n                    cast(\"transaction_status\" as varchar(16)) as \"transaction_status\" ,\n                    cast(\"transaction_date\" as datetime2) as \"transaction_date\" ,\n                    cast(\"expected_delivery_date\" as varchar(16)) as \"expected_delivery_date\" ,\n                    cast(\"foreign_amount\" as int) as \"foreign_amount\" ,\n                    cast(\"foreign_currency\" as varchar(16)) as \"foreign_currency\" ,\n                    cast(\"quantity\" as int) as \"quantity\" ,\n                    cast(\"bu_rate\" as float) as \"bu_rate\" ,\n                    cast(\"bu_amount\" as float) as \"bu_amount\" ,\n                    cast(\"fk_item_nsid\" as varchar(50)) as \"fk_item_nsid\" ,\n                    cast(\"fk_bu_nsid\" as varchar(50)) as \"fk_bu_nsid\" ,\n                    cast(\"fk_customer_nsid\" as varchar(50)) as \"fk_customer_nsid\" ,\n                    cast(\"dbt_load_datetime\" as datetime2) as \"dbt_load_datetime\" ,\n                    cast(\"dbt_run_id\" as varchar(36)) as \"dbt_run_id\" ,\n                    cast(\"dbt_functional_snapshot_date\" as datetime2) as \"dbt_functional_snapshot_date\" \n\n            from \"netsuite\".\"prod_dwh\".\"historized_transaction_with_line\"\n\n            where YEAR(transaction_date) >= '2023' AND transaction_type IN ('Opportunity', 'Invoice', 'Sales Order', 'Journal Entry')\n        )\n\n        \n),\n\ndata_consolidation AS \n(\n    SELECT \n        t.* \n        , DENSE_RANK () OVER ( ORDER BY dbt_functional_snapshot_date DESC )                    AS snapshot_date_order\n        , \"hist_bu_code\",\n  \"hist_bu_country_code\",\n  \"hist_bu_currency\",\n  \"hist_bu_legal_name\",\n  \"hist_bu_commercial_group\",\n  \"live_bu_code\",\n  \"live_bu_country_code\",\n  \"live_bu_currency\",\n  \"live_bu_legal_name\",\n  \"live_bu_commercial_group\",\n  \"pk_bu_nsid\",\n  \"bu_nsid\"\n        , COALESCE( fx_dated.fx_rate_original_to_usd, fx_latest.fx_rate_original_to_usd )            AS fx_rate_original_to_usd\n        , COALESCE( fx_dated.fx_rate_original_to_dynamic, fx_latest.fx_rate_original_to_dynamic )    AS fx_rate_original_to_dynamic\n        , 'EUR'                                                    AS dynamic_target_currency\n    FROM union_current_and_snapshot t\n\n    \n    LEFT OUTER JOIN \"netsuite\".\"prod_bus\".\"dim_bu\" bu\n        ON bu.pk_bu_nsid = t.fk_bu_nsid\n        AND t.transaction_date BETWEEN bu.scd_valid_from_fill_date AND bu.scd_valid_to_fill_date\n\n    \n    LEFT OUTER JOIN \"netsuite\".\"prod_bus\".\"fact_fx_avg_rate_latest\" fx_latest\n        ON bu.hist_bu_currency = fx_latest.original_currency\n    LEFT OUTER JOIN \"netsuite\".\"prod_bus\".\"fact_fx_avg_rate_dated\" fx_dated\n        ON bu.hist_bu_currency = fx_dated.original_currency\n        AND EOMONTH(t.transaction_date) = fx_dated.closing_date\n)\n\nSELECT \n    * \n    , fx_rate_original_to_usd     * bu_amount AS usd_amount\n    , fx_rate_original_to_dynamic * bu_amount AS dynamic_amount\nFROM data_consolidation", "relation_name": "\"netsuite\".\"prod_bus\".\"fact_all_transactions_with_line\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-06T16:22:40.283119Z", "completed_at": "2024-10-06T16:22:40.288219Z"}, {"name": "execute", "started_at": "2024-10-06T16:22:40.288635Z", "completed_at": "2024-10-06T16:22:40.288642Z"}], "thread_id": "Thread-1", "execution_time": 0.0063898563385009766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.netsuite_project.not_null_prep_budget_for_union_live_bu_code.d946ceafd7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect live_bu_code\nfrom \"netsuite\".\"prod_prp\".\"prep_budget_for_union\"\nwhere live_bu_code is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-06T16:22:40.290545Z", "completed_at": "2024-10-06T16:22:41.216499Z"}, {"name": "execute", "started_at": "2024-10-06T16:22:41.216878Z", "completed_at": "2024-10-06T16:22:41.216890Z"}], "thread_id": "Thread-1", "execution_time": 0.9280016422271729, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.netsuite_project.dataset_sales_pipeline", "compiled": true, "compiled_code": "\n\nWITH cte_scope AS (\nSELECT \n    \"_dbt_source_relation\",\n  \"transaction_nsid\",\n  \"transaction_line_nsid\",\n  \"transaction_last_modified_date\",\n  \"transaction_line_last_modified_date\",\n  \"transaction_type\",\n  \"transaction_number\",\n  \"transaction_status\",\n  \"transaction_date\",\n  \"expected_delivery_date\",\n  \"foreign_amount\",\n  \"foreign_currency\",\n  \"quantity\",\n  \"bu_rate\",\n  \"bu_amount\",\n  \"fk_item_nsid\",\n  \"fk_bu_nsid\",\n  \"fk_customer_nsid\",\n  \"dbt_load_datetime\",\n  \"dbt_run_id\",\n  \"dbt_functional_snapshot_date\",\n  \"snapshot_date_order\",\n  \"hist_bu_code\",\n  \"hist_bu_country_code\",\n  \"hist_bu_currency\",\n  \"hist_bu_legal_name\",\n  \"hist_bu_commercial_group\",\n  \"live_bu_code\",\n  \"live_bu_country_code\",\n  \"live_bu_currency\",\n  \"live_bu_legal_name\",\n  \"live_bu_commercial_group\",\n  \"pk_bu_nsid\",\n  \"bu_nsid\",\n  \"fx_rate_original_to_usd\",\n  \"fx_rate_original_to_dynamic\",\n  \"dynamic_target_currency\",\n  \"usd_amount\",\n  \"dynamic_amount\"\n    , CAST ( CASE WHEN t.transaction_type IN ('Opportunity', 'Sales Order') THEN t.expected_delivery_date ELSE t.transaction_date END AS DATE ) AS calculation_date\nFROM \"netsuite\".\"prod_bus\".\"fact_all_transactions_with_line\" t \n\nWHERE t.transaction_type IN ( 'Opportunity', 'Invoice', 'Sales Order' )\nAND\n    ( \n        ( t.transaction_type NOT IN ('Opportunity', 'Sales Order') )\n        OR \n        ( t.transaction_type = 'Opportunity' AND t.transaction_status IN ( 'Under Discussion', 'Ongoing' ) )\n        OR\n        ( t.transaction_type = 'Sales Order' AND t.transaction_status IN ( 'Under Discussion', 'Ongoing' ) )\n    )\n)\n\n\n, cte_calculate AS (\nSELECT \n    t.*\n    \n        , IIF(d_calc.is_prev_2y_fiscal_year = 1, bu_amount, 0) AS total_bu_amount_prev_2y_fiscal_year\n        , IIF(d_calc.is_prev_1y_fiscal_year = 1, bu_amount, 0) AS total_bu_amount_prev_1y_fiscal_year\n        , IIF(d_calc.is_current_fiscal_year = 1, bu_amount, 0) AS total_bu_amount_current_fiscal_year\n        , IIF(d_calc.is_next_1y_fiscal_year = 1, bu_amount, 0) AS total_bu_amount_next_1y_fiscal_year\n    \n        , IIF(d_calc.is_prev_2y_fiscal_year = 1, usd_amount, 0) AS total_usd_amount_prev_2y_fiscal_year\n        , IIF(d_calc.is_prev_1y_fiscal_year = 1, usd_amount, 0) AS total_usd_amount_prev_1y_fiscal_year\n        , IIF(d_calc.is_current_fiscal_year = 1, usd_amount, 0) AS total_usd_amount_current_fiscal_year\n        , IIF(d_calc.is_next_1y_fiscal_year = 1, usd_amount, 0) AS total_usd_amount_next_1y_fiscal_year\n    \n        , IIF(d_calc.is_prev_2y_fiscal_year = 1, dynamic_amount, 0) AS total_dynamic_amount_prev_2y_fiscal_year\n        , IIF(d_calc.is_prev_1y_fiscal_year = 1, dynamic_amount, 0) AS total_dynamic_amount_prev_1y_fiscal_year\n        , IIF(d_calc.is_current_fiscal_year = 1, dynamic_amount, 0) AS total_dynamic_amount_current_fiscal_year\n        , IIF(d_calc.is_next_1y_fiscal_year = 1, dynamic_amount, 0) AS total_dynamic_amount_next_1y_fiscal_year\n    \n    \n        \n        , IIF(d_calc.is_prev_2y_fiscal_year = 1 AND t.transaction_type = 'Opportunity', bu_amount, 0) AS opportunity_bu_amount_prev_2y_fiscal_year\n        , IIF(d_calc.is_prev_1y_fiscal_year = 1 AND t.transaction_type = 'Opportunity', bu_amount, 0) AS opportunity_bu_amount_prev_1y_fiscal_year\n        , IIF(d_calc.is_current_fiscal_year = 1 AND t.transaction_type = 'Opportunity', bu_amount, 0) AS opportunity_bu_amount_current_fiscal_year\n        , IIF(d_calc.is_next_1y_fiscal_year = 1 AND t.transaction_type = 'Opportunity', bu_amount, 0) AS opportunity_bu_amount_next_1y_fiscal_year\n        \n        , IIF(d_calc.is_prev_2y_fiscal_year = 1 AND t.transaction_type = 'Invoice', bu_amount, 0) AS invoice_bu_amount_prev_2y_fiscal_year\n        , IIF(d_calc.is_prev_1y_fiscal_year = 1 AND t.transaction_type = 'Invoice', bu_amount, 0) AS invoice_bu_amount_prev_1y_fiscal_year\n        , IIF(d_calc.is_current_fiscal_year = 1 AND t.transaction_type = 'Invoice', bu_amount, 0) AS invoice_bu_amount_current_fiscal_year\n        , IIF(d_calc.is_next_1y_fiscal_year = 1 AND t.transaction_type = 'Invoice', bu_amount, 0) AS invoice_bu_amount_next_1y_fiscal_year\n        \n        , IIF(d_calc.is_prev_2y_fiscal_year = 1 AND t.transaction_type = 'Sales Order', bu_amount, 0) AS sales_order_bu_amount_prev_2y_fiscal_year\n        , IIF(d_calc.is_prev_1y_fiscal_year = 1 AND t.transaction_type = 'Sales Order', bu_amount, 0) AS sales_order_bu_amount_prev_1y_fiscal_year\n        , IIF(d_calc.is_current_fiscal_year = 1 AND t.transaction_type = 'Sales Order', bu_amount, 0) AS sales_order_bu_amount_current_fiscal_year\n        , IIF(d_calc.is_next_1y_fiscal_year = 1 AND t.transaction_type = 'Sales Order', bu_amount, 0) AS sales_order_bu_amount_next_1y_fiscal_year\n        \n    \n        \n        , IIF(d_calc.is_prev_2y_fiscal_year = 1 AND t.transaction_type = 'Opportunity', usd_amount, 0) AS opportunity_usd_amount_prev_2y_fiscal_year\n        , IIF(d_calc.is_prev_1y_fiscal_year = 1 AND t.transaction_type = 'Opportunity', usd_amount, 0) AS opportunity_usd_amount_prev_1y_fiscal_year\n        , IIF(d_calc.is_current_fiscal_year = 1 AND t.transaction_type = 'Opportunity', usd_amount, 0) AS opportunity_usd_amount_current_fiscal_year\n        , IIF(d_calc.is_next_1y_fiscal_year = 1 AND t.transaction_type = 'Opportunity', usd_amount, 0) AS opportunity_usd_amount_next_1y_fiscal_year\n        \n        , IIF(d_calc.is_prev_2y_fiscal_year = 1 AND t.transaction_type = 'Invoice', usd_amount, 0) AS invoice_usd_amount_prev_2y_fiscal_year\n        , IIF(d_calc.is_prev_1y_fiscal_year = 1 AND t.transaction_type = 'Invoice', usd_amount, 0) AS invoice_usd_amount_prev_1y_fiscal_year\n        , IIF(d_calc.is_current_fiscal_year = 1 AND t.transaction_type = 'Invoice', usd_amount, 0) AS invoice_usd_amount_current_fiscal_year\n        , IIF(d_calc.is_next_1y_fiscal_year = 1 AND t.transaction_type = 'Invoice', usd_amount, 0) AS invoice_usd_amount_next_1y_fiscal_year\n        \n        , IIF(d_calc.is_prev_2y_fiscal_year = 1 AND t.transaction_type = 'Sales Order', usd_amount, 0) AS sales_order_usd_amount_prev_2y_fiscal_year\n        , IIF(d_calc.is_prev_1y_fiscal_year = 1 AND t.transaction_type = 'Sales Order', usd_amount, 0) AS sales_order_usd_amount_prev_1y_fiscal_year\n        , IIF(d_calc.is_current_fiscal_year = 1 AND t.transaction_type = 'Sales Order', usd_amount, 0) AS sales_order_usd_amount_current_fiscal_year\n        , IIF(d_calc.is_next_1y_fiscal_year = 1 AND t.transaction_type = 'Sales Order', usd_amount, 0) AS sales_order_usd_amount_next_1y_fiscal_year\n        \n    \n        \n        , IIF(d_calc.is_prev_2y_fiscal_year = 1 AND t.transaction_type = 'Opportunity', dynamic_amount, 0) AS opportunity_dynamic_amount_prev_2y_fiscal_year\n        , IIF(d_calc.is_prev_1y_fiscal_year = 1 AND t.transaction_type = 'Opportunity', dynamic_amount, 0) AS opportunity_dynamic_amount_prev_1y_fiscal_year\n        , IIF(d_calc.is_current_fiscal_year = 1 AND t.transaction_type = 'Opportunity', dynamic_amount, 0) AS opportunity_dynamic_amount_current_fiscal_year\n        , IIF(d_calc.is_next_1y_fiscal_year = 1 AND t.transaction_type = 'Opportunity', dynamic_amount, 0) AS opportunity_dynamic_amount_next_1y_fiscal_year\n        \n        , IIF(d_calc.is_prev_2y_fiscal_year = 1 AND t.transaction_type = 'Invoice', dynamic_amount, 0) AS invoice_dynamic_amount_prev_2y_fiscal_year\n        , IIF(d_calc.is_prev_1y_fiscal_year = 1 AND t.transaction_type = 'Invoice', dynamic_amount, 0) AS invoice_dynamic_amount_prev_1y_fiscal_year\n        , IIF(d_calc.is_current_fiscal_year = 1 AND t.transaction_type = 'Invoice', dynamic_amount, 0) AS invoice_dynamic_amount_current_fiscal_year\n        , IIF(d_calc.is_next_1y_fiscal_year = 1 AND t.transaction_type = 'Invoice', dynamic_amount, 0) AS invoice_dynamic_amount_next_1y_fiscal_year\n        \n        , IIF(d_calc.is_prev_2y_fiscal_year = 1 AND t.transaction_type = 'Sales Order', dynamic_amount, 0) AS sales_order_dynamic_amount_prev_2y_fiscal_year\n        , IIF(d_calc.is_prev_1y_fiscal_year = 1 AND t.transaction_type = 'Sales Order', dynamic_amount, 0) AS sales_order_dynamic_amount_prev_1y_fiscal_year\n        , IIF(d_calc.is_current_fiscal_year = 1 AND t.transaction_type = 'Sales Order', dynamic_amount, 0) AS sales_order_dynamic_amount_current_fiscal_year\n        , IIF(d_calc.is_next_1y_fiscal_year = 1 AND t.transaction_type = 'Sales Order', dynamic_amount, 0) AS sales_order_dynamic_amount_next_1y_fiscal_year\n        \n    \nFROM cte_scope t \nLEFT OUTER JOIN \"netsuite\".\"prod_bus\".\"dim_date\" d_calc\n    ON d_calc.pk_date_standard = t.calculation_date \n)\n\nSELECT \n    t.*\n    , \"hist_item_name\",\n  \"hist_item_code\",\n  \"hist_item_type\",\n  \"hist_project_code\",\n  \"hist_item_category\",\n  \"hist_item_sub_category\",\n  \"hist_item_pattern\",\n  \"live_item_name\",\n  \"live_item_code\",\n  \"live_item_type\",\n  \"live_project_code\",\n  \"live_item_category\",\n  \"live_item_sub_category\",\n  \"live_item_pattern\",\n  \"pk_item_nsid\",\n  \"item_nsid\"\n    , \"hist_customer_name\",\n  \"hist_customer_tier\",\n  \"live_customer_name\",\n  \"live_customer_tier\",\n  \"pk_customer_nsid\",\n  \"customer_nsid\"\nFROM cte_calculate t\nLEFT OUTER JOIN \"netsuite\".\"prod_bus\".\"dim_customer\" cu\n    ON cu.pk_customer_nsid = t.fk_customer_nsid\n    AND t.transaction_date BETWEEN cu.scd_valid_from_fill_date AND cu.scd_valid_to_fill_date\nLEFT OUTER JOIN \"netsuite\".\"prod_bus\".\"dim_item\" it\n    ON it.pk_item_nsid = t.fk_item_nsid\n    AND t.transaction_date BETWEEN it.scd_valid_from_fill_date AND it.scd_valid_to_fill_date", "relation_name": "\"netsuite\".\"prod_ds\".\"dataset_sales_pipeline\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-06T16:22:41.219879Z", "completed_at": "2024-10-06T16:22:41.225294Z"}, {"name": "execute", "started_at": "2024-10-06T16:22:41.225680Z", "completed_at": "2024-10-06T16:22:41.225692Z"}], "thread_id": "Thread-1", "execution_time": 0.006845712661743164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.netsuite_project.not_null_fact_all_transactions_with_line_fx_rate_original_to_dynamic.80ae594c95", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect fx_rate_original_to_dynamic\nfrom \"netsuite\".\"prod_bus\".\"fact_all_transactions_with_line\"\nwhere fx_rate_original_to_dynamic is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-06T16:22:41.227635Z", "completed_at": "2024-10-06T16:22:41.232452Z"}, {"name": "execute", "started_at": "2024-10-06T16:22:41.232816Z", "completed_at": "2024-10-06T16:22:41.232822Z"}], "thread_id": "Thread-1", "execution_time": 0.006064176559448242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.netsuite_project.not_null_fact_all_transactions_with_line_fx_rate_original_to_usd.0896bf129b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect fx_rate_original_to_usd\nfrom \"netsuite\".\"prod_bus\".\"fact_all_transactions_with_line\"\nwhere fx_rate_original_to_usd is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-06T16:22:41.234762Z", "completed_at": "2024-10-06T16:22:42.409854Z"}, {"name": "execute", "started_at": "2024-10-06T16:22:42.410232Z", "completed_at": "2024-10-06T16:22:42.410245Z"}], "thread_id": "Thread-1", "execution_time": 1.177182912826538, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.netsuite_project.dataset_sales_pipeline_monitoring", "compiled": true, "compiled_code": "\n\nWITH unioned_data AS (\n    \n\n        (\n            select\n                cast('\"netsuite\".\"prod_ds\".\"dataset_sales_pipeline\"' as VARCHAR(8000)) as _dbt_source_relation,\n\n                \n                    cast(\"transaction_nsid\" as int) as \"transaction_nsid\" ,\n                    cast(\"transaction_line_nsid\" as int) as \"transaction_line_nsid\" ,\n                    cast(\"transaction_last_modified_date\" as varchar(16)) as \"transaction_last_modified_date\" ,\n                    cast(\"transaction_line_last_modified_date\" as varchar(16)) as \"transaction_line_last_modified_date\" ,\n                    cast(\"transaction_type\" as varchar(16)) as \"transaction_type\" ,\n                    cast(\"transaction_number\" as varchar(16)) as \"transaction_number\" ,\n                    cast(\"transaction_status\" as varchar(16)) as \"transaction_status\" ,\n                    cast(\"transaction_date\" as datetime2) as \"transaction_date\" ,\n                    cast(\"expected_delivery_date\" as varchar(16)) as \"expected_delivery_date\" ,\n                    cast(\"foreign_amount\" as int) as \"foreign_amount\" ,\n                    cast(\"foreign_currency\" as varchar(16)) as \"foreign_currency\" ,\n                    cast(\"quantity\" as int) as \"quantity\" ,\n                    cast(\"bu_rate\" as float) as \"bu_rate\" ,\n                    cast(\"bu_amount\" as float) as \"bu_amount\" ,\n                    cast(\"fk_item_nsid\" as varchar(50)) as \"fk_item_nsid\" ,\n                    cast(\"fk_bu_nsid\" as varchar(50)) as \"fk_bu_nsid\" ,\n                    cast(\"fk_customer_nsid\" as varchar(50)) as \"fk_customer_nsid\" ,\n                    cast(\"dbt_load_datetime\" as datetime2) as \"dbt_load_datetime\" ,\n                    cast(\"dbt_run_id\" as varchar(36)) as \"dbt_run_id\" ,\n                    cast(\"dbt_functional_snapshot_date\" as datetime2) as \"dbt_functional_snapshot_date\" ,\n                    cast(\"snapshot_date_order\" as bigint) as \"snapshot_date_order\" ,\n                    cast(\"hist_bu_code\" as varchar(16)) as \"hist_bu_code\" ,\n                    cast(\"hist_bu_country_code\" as varchar(16)) as \"hist_bu_country_code\" ,\n                    cast(\"hist_bu_currency\" as varchar(16)) as \"hist_bu_currency\" ,\n                    cast(\"hist_bu_legal_name\" as varchar(66)) as \"hist_bu_legal_name\" ,\n                    cast(\"hist_bu_commercial_group\" as varchar(16)) as \"hist_bu_commercial_group\" ,\n                    cast(\"live_bu_code\" as varchar(16)) as \"live_bu_code\" ,\n                    cast(\"live_bu_country_code\" as varchar(16)) as \"live_bu_country_code\" ,\n                    cast(\"live_bu_currency\" as varchar(16)) as \"live_bu_currency\" ,\n                    cast(\"live_bu_legal_name\" as varchar(66)) as \"live_bu_legal_name\" ,\n                    cast(\"live_bu_commercial_group\" as varchar(16)) as \"live_bu_commercial_group\" ,\n                    cast(\"pk_bu_nsid\" as varchar(50)) as \"pk_bu_nsid\" ,\n                    cast(\"bu_nsid\" as int) as \"bu_nsid\" ,\n                    cast(\"fx_rate_original_to_usd\" as float) as \"fx_rate_original_to_usd\" ,\n                    cast(\"fx_rate_original_to_dynamic\" as float) as \"fx_rate_original_to_dynamic\" ,\n                    cast(\"dynamic_target_currency\" as varchar(3)) as \"dynamic_target_currency\" ,\n                    cast(\"usd_amount\" as float) as \"usd_amount\" ,\n                    cast(\"dynamic_amount\" as float) as \"dynamic_amount\" ,\n                    cast(\"calculation_date\" as date) as \"calculation_date\" ,\n                    cast(\"total_bu_amount_prev_2y_fiscal_year\" as float) as \"total_bu_amount_prev_2y_fiscal_year\" ,\n                    cast(\"total_bu_amount_prev_1y_fiscal_year\" as float) as \"total_bu_amount_prev_1y_fiscal_year\" ,\n                    cast(\"total_bu_amount_current_fiscal_year\" as float) as \"total_bu_amount_current_fiscal_year\" ,\n                    cast(\"total_bu_amount_next_1y_fiscal_year\" as float) as \"total_bu_amount_next_1y_fiscal_year\" ,\n                    cast(\"total_usd_amount_prev_2y_fiscal_year\" as float) as \"total_usd_amount_prev_2y_fiscal_year\" ,\n                    cast(\"total_usd_amount_prev_1y_fiscal_year\" as float) as \"total_usd_amount_prev_1y_fiscal_year\" ,\n                    cast(\"total_usd_amount_current_fiscal_year\" as float) as \"total_usd_amount_current_fiscal_year\" ,\n                    cast(\"total_usd_amount_next_1y_fiscal_year\" as float) as \"total_usd_amount_next_1y_fiscal_year\" ,\n                    cast(\"total_dynamic_amount_prev_2y_fiscal_year\" as float) as \"total_dynamic_amount_prev_2y_fiscal_year\" ,\n                    cast(\"total_dynamic_amount_prev_1y_fiscal_year\" as float) as \"total_dynamic_amount_prev_1y_fiscal_year\" ,\n                    cast(\"total_dynamic_amount_current_fiscal_year\" as float) as \"total_dynamic_amount_current_fiscal_year\" ,\n                    cast(\"total_dynamic_amount_next_1y_fiscal_year\" as float) as \"total_dynamic_amount_next_1y_fiscal_year\" ,\n                    cast(\"opportunity_bu_amount_prev_2y_fiscal_year\" as float) as \"opportunity_bu_amount_prev_2y_fiscal_year\" ,\n                    cast(\"opportunity_bu_amount_prev_1y_fiscal_year\" as float) as \"opportunity_bu_amount_prev_1y_fiscal_year\" ,\n                    cast(\"opportunity_bu_amount_current_fiscal_year\" as float) as \"opportunity_bu_amount_current_fiscal_year\" ,\n                    cast(\"opportunity_bu_amount_next_1y_fiscal_year\" as float) as \"opportunity_bu_amount_next_1y_fiscal_year\" ,\n                    cast(\"invoice_bu_amount_prev_2y_fiscal_year\" as float) as \"invoice_bu_amount_prev_2y_fiscal_year\" ,\n                    cast(\"invoice_bu_amount_prev_1y_fiscal_year\" as float) as \"invoice_bu_amount_prev_1y_fiscal_year\" ,\n                    cast(\"invoice_bu_amount_current_fiscal_year\" as float) as \"invoice_bu_amount_current_fiscal_year\" ,\n                    cast(\"invoice_bu_amount_next_1y_fiscal_year\" as float) as \"invoice_bu_amount_next_1y_fiscal_year\" ,\n                    cast(\"sales_order_bu_amount_prev_2y_fiscal_year\" as float) as \"sales_order_bu_amount_prev_2y_fiscal_year\" ,\n                    cast(\"sales_order_bu_amount_prev_1y_fiscal_year\" as float) as \"sales_order_bu_amount_prev_1y_fiscal_year\" ,\n                    cast(\"sales_order_bu_amount_current_fiscal_year\" as float) as \"sales_order_bu_amount_current_fiscal_year\" ,\n                    cast(\"sales_order_bu_amount_next_1y_fiscal_year\" as float) as \"sales_order_bu_amount_next_1y_fiscal_year\" ,\n                    cast(\"opportunity_usd_amount_prev_2y_fiscal_year\" as float) as \"opportunity_usd_amount_prev_2y_fiscal_year\" ,\n                    cast(\"opportunity_usd_amount_prev_1y_fiscal_year\" as float) as \"opportunity_usd_amount_prev_1y_fiscal_year\" ,\n                    cast(\"opportunity_usd_amount_current_fiscal_year\" as float) as \"opportunity_usd_amount_current_fiscal_year\" ,\n                    cast(\"opportunity_usd_amount_next_1y_fiscal_year\" as float) as \"opportunity_usd_amount_next_1y_fiscal_year\" ,\n                    cast(\"invoice_usd_amount_prev_2y_fiscal_year\" as float) as \"invoice_usd_amount_prev_2y_fiscal_year\" ,\n                    cast(\"invoice_usd_amount_prev_1y_fiscal_year\" as float) as \"invoice_usd_amount_prev_1y_fiscal_year\" ,\n                    cast(\"invoice_usd_amount_current_fiscal_year\" as float) as \"invoice_usd_amount_current_fiscal_year\" ,\n                    cast(\"invoice_usd_amount_next_1y_fiscal_year\" as float) as \"invoice_usd_amount_next_1y_fiscal_year\" ,\n                    cast(\"sales_order_usd_amount_prev_2y_fiscal_year\" as float) as \"sales_order_usd_amount_prev_2y_fiscal_year\" ,\n                    cast(\"sales_order_usd_amount_prev_1y_fiscal_year\" as float) as \"sales_order_usd_amount_prev_1y_fiscal_year\" ,\n                    cast(\"sales_order_usd_amount_current_fiscal_year\" as float) as \"sales_order_usd_amount_current_fiscal_year\" ,\n                    cast(\"sales_order_usd_amount_next_1y_fiscal_year\" as float) as \"sales_order_usd_amount_next_1y_fiscal_year\" ,\n                    cast(\"opportunity_dynamic_amount_prev_2y_fiscal_year\" as float) as \"opportunity_dynamic_amount_prev_2y_fiscal_year\" ,\n                    cast(\"opportunity_dynamic_amount_prev_1y_fiscal_year\" as float) as \"opportunity_dynamic_amount_prev_1y_fiscal_year\" ,\n                    cast(\"opportunity_dynamic_amount_current_fiscal_year\" as float) as \"opportunity_dynamic_amount_current_fiscal_year\" ,\n                    cast(\"opportunity_dynamic_amount_next_1y_fiscal_year\" as float) as \"opportunity_dynamic_amount_next_1y_fiscal_year\" ,\n                    cast(\"invoice_dynamic_amount_prev_2y_fiscal_year\" as float) as \"invoice_dynamic_amount_prev_2y_fiscal_year\" ,\n                    cast(\"invoice_dynamic_amount_prev_1y_fiscal_year\" as float) as \"invoice_dynamic_amount_prev_1y_fiscal_year\" ,\n                    cast(\"invoice_dynamic_amount_current_fiscal_year\" as float) as \"invoice_dynamic_amount_current_fiscal_year\" ,\n                    cast(\"invoice_dynamic_amount_next_1y_fiscal_year\" as float) as \"invoice_dynamic_amount_next_1y_fiscal_year\" ,\n                    cast(\"sales_order_dynamic_amount_prev_2y_fiscal_year\" as float) as \"sales_order_dynamic_amount_prev_2y_fiscal_year\" ,\n                    cast(\"sales_order_dynamic_amount_prev_1y_fiscal_year\" as float) as \"sales_order_dynamic_amount_prev_1y_fiscal_year\" ,\n                    cast(\"sales_order_dynamic_amount_current_fiscal_year\" as float) as \"sales_order_dynamic_amount_current_fiscal_year\" ,\n                    cast(\"sales_order_dynamic_amount_next_1y_fiscal_year\" as float) as \"sales_order_dynamic_amount_next_1y_fiscal_year\" ,\n                    cast(\"hist_item_name\" as varchar(21)) as \"hist_item_name\" ,\n                    cast(\"hist_item_code\" as varchar(16)) as \"hist_item_code\" ,\n                    cast(\"hist_item_type\" as varchar(16)) as \"hist_item_type\" ,\n                    cast(\"hist_project_code\" as varchar(16)) as \"hist_project_code\" ,\n                    cast(\"hist_item_category\" as varchar(19)) as \"hist_item_category\" ,\n                    cast(\"hist_item_sub_category\" as varchar(21)) as \"hist_item_sub_category\" ,\n                    cast(\"hist_item_pattern\" as varchar(16)) as \"hist_item_pattern\" ,\n                    cast(\"live_item_name\" as varchar(21)) as \"live_item_name\" ,\n                    cast(\"live_item_code\" as varchar(16)) as \"live_item_code\" ,\n                    cast(\"live_item_type\" as varchar(16)) as \"live_item_type\" ,\n                    cast(\"live_project_code\" as varchar(16)) as \"live_project_code\" ,\n                    cast(\"live_item_category\" as varchar(19)) as \"live_item_category\" ,\n                    cast(\"live_item_sub_category\" as varchar(21)) as \"live_item_sub_category\" ,\n                    cast(\"live_item_pattern\" as varchar(16)) as \"live_item_pattern\" ,\n                    cast(\"pk_item_nsid\" as varchar(50)) as \"pk_item_nsid\" ,\n                    cast(\"item_nsid\" as int) as \"item_nsid\" ,\n                    cast(\"hist_customer_name\" as varchar(31)) as \"hist_customer_name\" ,\n                    cast(\"hist_customer_tier\" as varchar(16)) as \"hist_customer_tier\" ,\n                    cast(\"live_customer_name\" as varchar(31)) as \"live_customer_name\" ,\n                    cast(\"live_customer_tier\" as varchar(16)) as \"live_customer_tier\" ,\n                    cast(\"pk_customer_nsid\" as varchar(50)) as \"pk_customer_nsid\" ,\n                    cast(\"customer_nsid\" as int) as \"customer_nsid\" ,\n                    cast(null as int) as \"budget_year\" ,\n                    cast(null as varchar(16)) as \"budget_version\" ,\n                    cast(null as float) as \"budget_sales_amount_bu_currency\" ,\n                    cast(null as float) as \"budget_sales_amount_usd_currency\" ,\n                    cast(null as float) as \"budget_sales_amount_dynamic_currency\" \n\n            from \"netsuite\".\"prod_ds\".\"dataset_sales_pipeline\"\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('\"netsuite\".\"prod_prp\".\"prep_budget_for_union\"' as VARCHAR(8000)) as _dbt_source_relation,\n\n                \n                    cast(null as int) as \"transaction_nsid\" ,\n                    cast(null as int) as \"transaction_line_nsid\" ,\n                    cast(null as varchar(16)) as \"transaction_last_modified_date\" ,\n                    cast(null as varchar(16)) as \"transaction_line_last_modified_date\" ,\n                    cast(\"transaction_type\" as varchar(16)) as \"transaction_type\" ,\n                    cast(null as varchar(16)) as \"transaction_number\" ,\n                    cast(null as varchar(16)) as \"transaction_status\" ,\n                    cast(null as datetime2) as \"transaction_date\" ,\n                    cast(null as varchar(16)) as \"expected_delivery_date\" ,\n                    cast(null as int) as \"foreign_amount\" ,\n                    cast(null as varchar(16)) as \"foreign_currency\" ,\n                    cast(null as int) as \"quantity\" ,\n                    cast(null as float) as \"bu_rate\" ,\n                    cast(null as float) as \"bu_amount\" ,\n                    cast(null as varchar(50)) as \"fk_item_nsid\" ,\n                    cast(null as varchar(50)) as \"fk_bu_nsid\" ,\n                    cast(null as varchar(50)) as \"fk_customer_nsid\" ,\n                    cast(null as datetime2) as \"dbt_load_datetime\" ,\n                    cast(null as varchar(36)) as \"dbt_run_id\" ,\n                    cast(null as datetime2) as \"dbt_functional_snapshot_date\" ,\n                    cast(null as bigint) as \"snapshot_date_order\" ,\n                    cast(\"hist_bu_code\" as varchar(16)) as \"hist_bu_code\" ,\n                    cast(\"hist_bu_country_code\" as varchar(16)) as \"hist_bu_country_code\" ,\n                    cast(\"hist_bu_currency\" as varchar(16)) as \"hist_bu_currency\" ,\n                    cast(\"hist_bu_legal_name\" as varchar(66)) as \"hist_bu_legal_name\" ,\n                    cast(\"hist_bu_commercial_group\" as varchar(16)) as \"hist_bu_commercial_group\" ,\n                    cast(\"live_bu_code\" as varchar(16)) as \"live_bu_code\" ,\n                    cast(\"live_bu_country_code\" as varchar(16)) as \"live_bu_country_code\" ,\n                    cast(\"live_bu_currency\" as varchar(16)) as \"live_bu_currency\" ,\n                    cast(\"live_bu_legal_name\" as varchar(66)) as \"live_bu_legal_name\" ,\n                    cast(\"live_bu_commercial_group\" as varchar(16)) as \"live_bu_commercial_group\" ,\n                    cast(\"pk_bu_nsid\" as varchar(50)) as \"pk_bu_nsid\" ,\n                    cast(\"bu_nsid\" as int) as \"bu_nsid\" ,\n                    cast(\"fx_rate_original_to_usd\" as float) as \"fx_rate_original_to_usd\" ,\n                    cast(\"fx_rate_original_to_dynamic\" as float) as \"fx_rate_original_to_dynamic\" ,\n                    cast(\"dynamic_target_currency\" as varchar(3)) as \"dynamic_target_currency\" ,\n                    cast(null as float) as \"usd_amount\" ,\n                    cast(null as float) as \"dynamic_amount\" ,\n                    cast(\"calculation_date\" as date) as \"calculation_date\" ,\n                    cast(null as float) as \"total_bu_amount_prev_2y_fiscal_year\" ,\n                    cast(null as float) as \"total_bu_amount_prev_1y_fiscal_year\" ,\n                    cast(null as float) as \"total_bu_amount_current_fiscal_year\" ,\n                    cast(null as float) as \"total_bu_amount_next_1y_fiscal_year\" ,\n                    cast(null as float) as \"total_usd_amount_prev_2y_fiscal_year\" ,\n                    cast(null as float) as \"total_usd_amount_prev_1y_fiscal_year\" ,\n                    cast(null as float) as \"total_usd_amount_current_fiscal_year\" ,\n                    cast(null as float) as \"total_usd_amount_next_1y_fiscal_year\" ,\n                    cast(null as float) as \"total_dynamic_amount_prev_2y_fiscal_year\" ,\n                    cast(null as float) as \"total_dynamic_amount_prev_1y_fiscal_year\" ,\n                    cast(null as float) as \"total_dynamic_amount_current_fiscal_year\" ,\n                    cast(null as float) as \"total_dynamic_amount_next_1y_fiscal_year\" ,\n                    cast(null as float) as \"opportunity_bu_amount_prev_2y_fiscal_year\" ,\n                    cast(null as float) as \"opportunity_bu_amount_prev_1y_fiscal_year\" ,\n                    cast(null as float) as \"opportunity_bu_amount_current_fiscal_year\" ,\n                    cast(null as float) as \"opportunity_bu_amount_next_1y_fiscal_year\" ,\n                    cast(null as float) as \"invoice_bu_amount_prev_2y_fiscal_year\" ,\n                    cast(null as float) as \"invoice_bu_amount_prev_1y_fiscal_year\" ,\n                    cast(null as float) as \"invoice_bu_amount_current_fiscal_year\" ,\n                    cast(null as float) as \"invoice_bu_amount_next_1y_fiscal_year\" ,\n                    cast(null as float) as \"sales_order_bu_amount_prev_2y_fiscal_year\" ,\n                    cast(null as float) as \"sales_order_bu_amount_prev_1y_fiscal_year\" ,\n                    cast(null as float) as \"sales_order_bu_amount_current_fiscal_year\" ,\n                    cast(null as float) as \"sales_order_bu_amount_next_1y_fiscal_year\" ,\n                    cast(null as float) as \"opportunity_usd_amount_prev_2y_fiscal_year\" ,\n                    cast(null as float) as \"opportunity_usd_amount_prev_1y_fiscal_year\" ,\n                    cast(null as float) as \"opportunity_usd_amount_current_fiscal_year\" ,\n                    cast(null as float) as \"opportunity_usd_amount_next_1y_fiscal_year\" ,\n                    cast(null as float) as \"invoice_usd_amount_prev_2y_fiscal_year\" ,\n                    cast(null as float) as \"invoice_usd_amount_prev_1y_fiscal_year\" ,\n                    cast(null as float) as \"invoice_usd_amount_current_fiscal_year\" ,\n                    cast(null as float) as \"invoice_usd_amount_next_1y_fiscal_year\" ,\n                    cast(null as float) as \"sales_order_usd_amount_prev_2y_fiscal_year\" ,\n                    cast(null as float) as \"sales_order_usd_amount_prev_1y_fiscal_year\" ,\n                    cast(null as float) as \"sales_order_usd_amount_current_fiscal_year\" ,\n                    cast(null as float) as \"sales_order_usd_amount_next_1y_fiscal_year\" ,\n                    cast(null as float) as \"opportunity_dynamic_amount_prev_2y_fiscal_year\" ,\n                    cast(null as float) as \"opportunity_dynamic_amount_prev_1y_fiscal_year\" ,\n                    cast(null as float) as \"opportunity_dynamic_amount_current_fiscal_year\" ,\n                    cast(null as float) as \"opportunity_dynamic_amount_next_1y_fiscal_year\" ,\n                    cast(null as float) as \"invoice_dynamic_amount_prev_2y_fiscal_year\" ,\n                    cast(null as float) as \"invoice_dynamic_amount_prev_1y_fiscal_year\" ,\n                    cast(null as float) as \"invoice_dynamic_amount_current_fiscal_year\" ,\n                    cast(null as float) as \"invoice_dynamic_amount_next_1y_fiscal_year\" ,\n                    cast(null as float) as \"sales_order_dynamic_amount_prev_2y_fiscal_year\" ,\n                    cast(null as float) as \"sales_order_dynamic_amount_prev_1y_fiscal_year\" ,\n                    cast(null as float) as \"sales_order_dynamic_amount_current_fiscal_year\" ,\n                    cast(null as float) as \"sales_order_dynamic_amount_next_1y_fiscal_year\" ,\n                    cast(null as varchar(21)) as \"hist_item_name\" ,\n                    cast(null as varchar(16)) as \"hist_item_code\" ,\n                    cast(null as varchar(16)) as \"hist_item_type\" ,\n                    cast(null as varchar(16)) as \"hist_project_code\" ,\n                    cast(null as varchar(19)) as \"hist_item_category\" ,\n                    cast(null as varchar(21)) as \"hist_item_sub_category\" ,\n                    cast(null as varchar(16)) as \"hist_item_pattern\" ,\n                    cast(null as varchar(21)) as \"live_item_name\" ,\n                    cast(null as varchar(16)) as \"live_item_code\" ,\n                    cast(null as varchar(16)) as \"live_item_type\" ,\n                    cast(null as varchar(16)) as \"live_project_code\" ,\n                    cast(null as varchar(19)) as \"live_item_category\" ,\n                    cast(null as varchar(21)) as \"live_item_sub_category\" ,\n                    cast(null as varchar(16)) as \"live_item_pattern\" ,\n                    cast(null as varchar(50)) as \"pk_item_nsid\" ,\n                    cast(null as int) as \"item_nsid\" ,\n                    cast(\"hist_customer_name\" as varchar(31)) as \"hist_customer_name\" ,\n                    cast(null as varchar(16)) as \"hist_customer_tier\" ,\n                    cast(\"live_customer_name\" as varchar(31)) as \"live_customer_name\" ,\n                    cast(null as varchar(16)) as \"live_customer_tier\" ,\n                    cast(null as varchar(50)) as \"pk_customer_nsid\" ,\n                    cast(null as int) as \"customer_nsid\" ,\n                    cast(\"budget_year\" as int) as \"budget_year\" ,\n                    cast(\"budget_version\" as varchar(16)) as \"budget_version\" ,\n                    cast(\"budget_sales_amount_bu_currency\" as float) as \"budget_sales_amount_bu_currency\" ,\n                    cast(\"budget_sales_amount_usd_currency\" as float) as \"budget_sales_amount_usd_currency\" ,\n                    cast(\"budget_sales_amount_dynamic_currency\" as float) as \"budget_sales_amount_dynamic_currency\" \n\n            from \"netsuite\".\"prod_prp\".\"prep_budget_for_union\"\n\n            \n        )\n\n        \n)\n\nSELECT\n    \n            _dbt_source_relation,\n            COALESCE(transaction_nsid, 0) as transaction_nsid,\n            COALESCE(transaction_line_nsid, 0) as transaction_line_nsid,\n            transaction_last_modified_date,\n            transaction_line_last_modified_date,\n            transaction_type,\n            transaction_number,\n            transaction_status,\n            transaction_date,\n            expected_delivery_date,\n            COALESCE(foreign_amount, 0) as foreign_amount,\n            foreign_currency,\n            COALESCE(quantity, 0) as quantity,\n            COALESCE(bu_rate, 0) as bu_rate,\n            COALESCE(bu_amount, 0) as bu_amount,\n            fk_item_nsid,\n            fk_bu_nsid,\n            fk_customer_nsid,\n            dbt_load_datetime,\n            dbt_run_id,\n            dbt_functional_snapshot_date,\n            COALESCE(snapshot_date_order, 0) as snapshot_date_order,\n            hist_bu_code,\n            hist_bu_country_code,\n            hist_bu_currency,\n            hist_bu_legal_name,\n            hist_bu_commercial_group,\n            live_bu_code,\n            live_bu_country_code,\n            live_bu_currency,\n            live_bu_legal_name,\n            live_bu_commercial_group,\n            pk_bu_nsid,\n            COALESCE(bu_nsid, 0) as bu_nsid,\n            COALESCE(fx_rate_original_to_usd, 0) as fx_rate_original_to_usd,\n            COALESCE(fx_rate_original_to_dynamic, 0) as fx_rate_original_to_dynamic,\n            dynamic_target_currency,\n            COALESCE(usd_amount, 0) as usd_amount,\n            COALESCE(dynamic_amount, 0) as dynamic_amount,\n            calculation_date,\n            COALESCE(total_bu_amount_prev_2y_fiscal_year, 0) as total_bu_amount_prev_2y_fiscal_year,\n            COALESCE(total_bu_amount_prev_1y_fiscal_year, 0) as total_bu_amount_prev_1y_fiscal_year,\n            COALESCE(total_bu_amount_current_fiscal_year, 0) as total_bu_amount_current_fiscal_year,\n            COALESCE(total_bu_amount_next_1y_fiscal_year, 0) as total_bu_amount_next_1y_fiscal_year,\n            COALESCE(total_usd_amount_prev_2y_fiscal_year, 0) as total_usd_amount_prev_2y_fiscal_year,\n            COALESCE(total_usd_amount_prev_1y_fiscal_year, 0) as total_usd_amount_prev_1y_fiscal_year,\n            COALESCE(total_usd_amount_current_fiscal_year, 0) as total_usd_amount_current_fiscal_year,\n            COALESCE(total_usd_amount_next_1y_fiscal_year, 0) as total_usd_amount_next_1y_fiscal_year,\n            COALESCE(total_dynamic_amount_prev_2y_fiscal_year, 0) as total_dynamic_amount_prev_2y_fiscal_year,\n            COALESCE(total_dynamic_amount_prev_1y_fiscal_year, 0) as total_dynamic_amount_prev_1y_fiscal_year,\n            COALESCE(total_dynamic_amount_current_fiscal_year, 0) as total_dynamic_amount_current_fiscal_year,\n            COALESCE(total_dynamic_amount_next_1y_fiscal_year, 0) as total_dynamic_amount_next_1y_fiscal_year,\n            COALESCE(opportunity_bu_amount_prev_2y_fiscal_year, 0) as opportunity_bu_amount_prev_2y_fiscal_year,\n            COALESCE(opportunity_bu_amount_prev_1y_fiscal_year, 0) as opportunity_bu_amount_prev_1y_fiscal_year,\n            COALESCE(opportunity_bu_amount_current_fiscal_year, 0) as opportunity_bu_amount_current_fiscal_year,\n            COALESCE(opportunity_bu_amount_next_1y_fiscal_year, 0) as opportunity_bu_amount_next_1y_fiscal_year,\n            COALESCE(invoice_bu_amount_prev_2y_fiscal_year, 0) as invoice_bu_amount_prev_2y_fiscal_year,\n            COALESCE(invoice_bu_amount_prev_1y_fiscal_year, 0) as invoice_bu_amount_prev_1y_fiscal_year,\n            COALESCE(invoice_bu_amount_current_fiscal_year, 0) as invoice_bu_amount_current_fiscal_year,\n            COALESCE(invoice_bu_amount_next_1y_fiscal_year, 0) as invoice_bu_amount_next_1y_fiscal_year,\n            COALESCE(sales_order_bu_amount_prev_2y_fiscal_year, 0) as sales_order_bu_amount_prev_2y_fiscal_year,\n            COALESCE(sales_order_bu_amount_prev_1y_fiscal_year, 0) as sales_order_bu_amount_prev_1y_fiscal_year,\n            COALESCE(sales_order_bu_amount_current_fiscal_year, 0) as sales_order_bu_amount_current_fiscal_year,\n            COALESCE(sales_order_bu_amount_next_1y_fiscal_year, 0) as sales_order_bu_amount_next_1y_fiscal_year,\n            COALESCE(opportunity_usd_amount_prev_2y_fiscal_year, 0) as opportunity_usd_amount_prev_2y_fiscal_year,\n            COALESCE(opportunity_usd_amount_prev_1y_fiscal_year, 0) as opportunity_usd_amount_prev_1y_fiscal_year,\n            COALESCE(opportunity_usd_amount_current_fiscal_year, 0) as opportunity_usd_amount_current_fiscal_year,\n            COALESCE(opportunity_usd_amount_next_1y_fiscal_year, 0) as opportunity_usd_amount_next_1y_fiscal_year,\n            COALESCE(invoice_usd_amount_prev_2y_fiscal_year, 0) as invoice_usd_amount_prev_2y_fiscal_year,\n            COALESCE(invoice_usd_amount_prev_1y_fiscal_year, 0) as invoice_usd_amount_prev_1y_fiscal_year,\n            COALESCE(invoice_usd_amount_current_fiscal_year, 0) as invoice_usd_amount_current_fiscal_year,\n            COALESCE(invoice_usd_amount_next_1y_fiscal_year, 0) as invoice_usd_amount_next_1y_fiscal_year,\n            COALESCE(sales_order_usd_amount_prev_2y_fiscal_year, 0) as sales_order_usd_amount_prev_2y_fiscal_year,\n            COALESCE(sales_order_usd_amount_prev_1y_fiscal_year, 0) as sales_order_usd_amount_prev_1y_fiscal_year,\n            COALESCE(sales_order_usd_amount_current_fiscal_year, 0) as sales_order_usd_amount_current_fiscal_year,\n            COALESCE(sales_order_usd_amount_next_1y_fiscal_year, 0) as sales_order_usd_amount_next_1y_fiscal_year,\n            COALESCE(opportunity_dynamic_amount_prev_2y_fiscal_year, 0) as opportunity_dynamic_amount_prev_2y_fiscal_year,\n            COALESCE(opportunity_dynamic_amount_prev_1y_fiscal_year, 0) as opportunity_dynamic_amount_prev_1y_fiscal_year,\n            COALESCE(opportunity_dynamic_amount_current_fiscal_year, 0) as opportunity_dynamic_amount_current_fiscal_year,\n            COALESCE(opportunity_dynamic_amount_next_1y_fiscal_year, 0) as opportunity_dynamic_amount_next_1y_fiscal_year,\n            COALESCE(invoice_dynamic_amount_prev_2y_fiscal_year, 0) as invoice_dynamic_amount_prev_2y_fiscal_year,\n            COALESCE(invoice_dynamic_amount_prev_1y_fiscal_year, 0) as invoice_dynamic_amount_prev_1y_fiscal_year,\n            COALESCE(invoice_dynamic_amount_current_fiscal_year, 0) as invoice_dynamic_amount_current_fiscal_year,\n            COALESCE(invoice_dynamic_amount_next_1y_fiscal_year, 0) as invoice_dynamic_amount_next_1y_fiscal_year,\n            COALESCE(sales_order_dynamic_amount_prev_2y_fiscal_year, 0) as sales_order_dynamic_amount_prev_2y_fiscal_year,\n            COALESCE(sales_order_dynamic_amount_prev_1y_fiscal_year, 0) as sales_order_dynamic_amount_prev_1y_fiscal_year,\n            COALESCE(sales_order_dynamic_amount_current_fiscal_year, 0) as sales_order_dynamic_amount_current_fiscal_year,\n            COALESCE(sales_order_dynamic_amount_next_1y_fiscal_year, 0) as sales_order_dynamic_amount_next_1y_fiscal_year,\n            hist_item_name,\n            hist_item_code,\n            hist_item_type,\n            hist_project_code,\n            hist_item_category,\n            hist_item_sub_category,\n            hist_item_pattern,\n            live_item_name,\n            live_item_code,\n            live_item_type,\n            live_project_code,\n            live_item_category,\n            live_item_sub_category,\n            live_item_pattern,\n            pk_item_nsid,\n            COALESCE(item_nsid, 0) as item_nsid,\n            hist_customer_name,\n            hist_customer_tier,\n            live_customer_name,\n            live_customer_tier,\n            pk_customer_nsid,\n            COALESCE(customer_nsid, 0) as customer_nsid,\n            budget_year,\n            budget_version,\n            budget_sales_amount_bu_currency,\n            budget_sales_amount_usd_currency,\n            budget_sales_amount_dynamic_currency\nFROM unioned_data", "relation_name": "\"netsuite\".\"prod_ds\".\"dataset_sales_pipeline_monitoring\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-06T16:22:42.413160Z", "completed_at": "2024-10-06T16:22:43.093796Z"}, {"name": "execute", "started_at": "2024-10-06T16:22:43.094176Z", "completed_at": "2024-10-06T16:22:43.094190Z"}], "thread_id": "Thread-1", "execution_time": 0.6823840141296387, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.netsuite_project.dataset_sales_pipeline_rls", "compiled": true, "compiled_code": "\n\n-- depends_on: \"netsuite\".\"prod_prp\".\"prep_rls_normalize\"\n\n\n\n\n\n\n\n    \n        SELECT\n            ds.*,\n            rls.user_email\n        FROM \"netsuite\".\"prod_ds\".\"dataset_sales_pipeline\" ds\n        LEFT JOIN \"netsuite\".\"prod_prp\".\"prep_rls_normalize\" rls\n            ON  \n        (ds.live_customer_name = rls.authorized_customer_name OR rls.authorized_customer_name = 'All')\n        AND (ds.live_bu_code = rls.authorized_bu_code OR rls.authorized_bu_code = 'All')\n        AND (ds.live_item_type = rls.authorized_item_type OR rls.authorized_item_type = 'All')\n    \n        WHERE rls.row_id = 1\n         UNION \n    \n        SELECT\n            ds.*,\n            rls.user_email\n        FROM \"netsuite\".\"prod_ds\".\"dataset_sales_pipeline\" ds\n        LEFT JOIN \"netsuite\".\"prod_prp\".\"prep_rls_normalize\" rls\n            ON  \n        (ds.live_customer_name = rls.authorized_customer_name OR rls.authorized_customer_name = 'All')\n        AND (ds.live_bu_code = rls.authorized_bu_code OR rls.authorized_bu_code = 'All')\n        AND (ds.live_item_type = rls.authorized_item_type OR rls.authorized_item_type = 'All')\n    \n        WHERE rls.row_id = 2\n        \n    \n\n\n", "relation_name": "\"netsuite\".\"prod_ds\".\"dataset_sales_pipeline_rls\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-06T16:22:43.096688Z", "completed_at": "2024-10-06T16:22:43.781384Z"}, {"name": "execute", "started_at": "2024-10-06T16:22:43.781761Z", "completed_at": "2024-10-06T16:22:43.781774Z"}], "thread_id": "Thread-1", "execution_time": 0.6865057945251465, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.netsuite_project.dataset_sales_pipeline_monitoring_rls", "compiled": true, "compiled_code": "\n\n-- depends_on: \"netsuite\".\"prod_prp\".\"prep_rls_normalize\"\n\n\n\n\n\n\n\n    \n        SELECT\n            ds.*,\n            rls.user_email\n        FROM \"netsuite\".\"prod_ds\".\"dataset_sales_pipeline_monitoring\" ds\n        LEFT JOIN \"netsuite\".\"prod_prp\".\"prep_rls_normalize\" rls\n            ON  \n        (ds.live_customer_name = rls.authorized_customer_name OR rls.authorized_customer_name = 'All')\n        AND (ds.live_bu_code = rls.authorized_bu_code OR rls.authorized_bu_code = 'All')\n        AND (ds.live_item_type = rls.authorized_item_type OR rls.authorized_item_type = 'All')\n    \n        WHERE rls.row_id = 1\n         UNION \n    \n        SELECT\n            ds.*,\n            rls.user_email\n        FROM \"netsuite\".\"prod_ds\".\"dataset_sales_pipeline_monitoring\" ds\n        LEFT JOIN \"netsuite\".\"prod_prp\".\"prep_rls_normalize\" rls\n            ON  \n        (ds.live_customer_name = rls.authorized_customer_name OR rls.authorized_customer_name = 'All')\n        AND (ds.live_bu_code = rls.authorized_bu_code OR rls.authorized_bu_code = 'All')\n        AND (ds.live_item_type = rls.authorized_item_type OR rls.authorized_item_type = 'All')\n    \n        WHERE rls.row_id = 2\n        \n    \n\n\n", "relation_name": "\"netsuite\".\"prod_ds\".\"dataset_sales_pipeline_monitoring_rls\""}], "elapsed_time": 14.375607967376709, "args": {"log_format": "default", "version_check": true, "warn_error_options": {"include": [], "exclude": []}, "introspect": true, "log_format_file": "debug", "send_anonymous_usage_stats": true, "invocation_command": "dbt compile --target prod", "profiles_dir": "/netsuite_project", "cache_selected_only": false, "write_json": true, "output": "text", "indirect_selection": "eager", "log_file_max_bytes": 10485760, "static_parser": true, "require_explicit_package_overrides_for_builtin_materializations": true, "target": "prod", "empty": false, "require_resource_names_without_spaces": false, "source_freshness_run_project_hooks": false, "which": "compile", "print": true, "use_colors": true, "enable_legacy_logger": false, "strict_mode": false, "use_colors_file": true, "log_level_file": "debug", "show_resource_report": false, "favor_state": false, "vars": {}, "defer": false, "log_level": "info", "populate_cache": true, "printer_width": 80, "select": [], "macro_debugging": false, "partial_parse_file_diff": true, "log_path": "/netsuite_project/logs", "partial_parse": true, "quiet": false, "exclude": [], "project_dir": "/netsuite_project", "inject_ephemeral_ctes": true}}